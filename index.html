<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RN Studio - Business Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            color: #666;
            -webkit-text-fill-color: #666;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 5px;
        }

        .nav-tab {
            padding: 12px 25px;
            margin: 0 5px;
            background: none;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #666;
        }

        .nav-tab.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .nav-tab:hover:not(.active) {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid #e9ecef;
        }

        .form-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #444;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #667eea;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h4 {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-card .value {
            font-size: 2em;
            font-weight: 700;
            color: #333;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .google-sheets-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px dashed #667eea;
        }

        .google-sheets-section h4 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .status-indicator {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-connected {
            background: #d4edda;
            color: #155724;
        }

        .status-disconnected {
            background: #f8d7da;
            color: #721c24;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
        .expense-breakdown-grid {
    display: grid;
    gap: 15px;
    margin-top: 20px;
}

.expense-category {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #dee2e6;
}

.category-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.category-name {
    font-weight: bold;
    color: #333;
}

.category-amount {
    color: #007bff;
    font-weight: bold;
}

.category-bar {
    background: #e9ecef;
    height: 10px;
    border-radius: 5px;
    overflow: hidden;
    margin-bottom: 5px;
}

.category-progress {
    background: linear-gradient(45deg, #007bff, #0056b3);
    height: 100%;
    border-radius: 5px;
    transition: width 0.3s ease;
}

.category-percentage {
    text-align: right;
    font-size: 12px;
    color: #6c757d;
}

.status-warning {
    background: #ffc107;
    color: #000;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.table-responsive {
    overflow-x: auto;
}

.table-responsive table {
    min-width: 100%;
    white-space: nowrap;
}

@media (max-width: 768px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
    
    .table-responsive {
        font-size: 14px;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>RN Studio</h1>
            <p>Professional Photography Business Manager</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">Dashboard</button>
            <button class="nav-tab" onclick="showTab('add-event')">Add Event</button>
            <button class="nav-tab" onclick="showTab('events')">View Events</button>
            <button class="nav-tab" onclick="showTab('photographers')">Photographers</button>
            <button class="nav-tab" onclick="showTab('salary-management')">Salary Management</button>
            <button class="nav-tab" onclick="showTab('expense-tracker')">Expense Tracker</button>
            <button class="nav-tab" onclick="showTab('salary-dashboard')">Salary Dashboard</button>
            <button class="nav-tab" onclick="showTab('analytics')">Analytics</button>
            <button class="nav-tab" onclick="showTab('settings')">Settings</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Total Events</h4>
                    <div class="value" id="totalEvents">0</div>
                </div>
                <div class="stat-card">
                    <h4>Total Revenue</h4>
                    <div class="value" id="totalRevenue">₹0</div>
                </div>
                <div class="stat-card">
                    <h4>Total Expenses</h4>
                    <div class="value" id="totalExpenses">₹0</div>
                </div>
                <div class="stat-card">
                    <h4>Net Profit</h4>
                    <div class="value" id="netProfit">₹0</div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Recent Events</h3>
                <table class="data-table" id="recentEventsTable">
                    <thead>
                        <tr>
                            <th>Event Name</th>
                            <th>Date</th>
                            <th>Prize</th>
                            <th>Photographer</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="recentEventsBody">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #666;">No events found</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Add Event Tab -->
        <div id="add-event" class="tab-content">
            <div class="form-section">
                <h3>Add New Event</h3>
                <form id="eventForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="eventName">Event Name</label>
                            <input type="text" id="eventName" name="eventName" required>
                        </div>
                        <div class="form-group">
                            <label for="eventDate">Event Date</label>
                            <input type="date" id="eventDate" name="eventDate" required>
                        </div>
                        <div class="form-group">
                            <label for="eventPrize">Event Prize (₹)</label>
                            <input type="number" id="eventPrize" name="eventPrize" required>
                        </div>
                        <div class="form-group">
                            <label for="eventExpenses">Event Expenses (₹)</label>
                            <input type="number" id="eventExpenses" name="eventExpenses">
                        </div>
                        <div class="form-group">
                            <label for="photographerName">Photographer</label>
                            <select id="photographerName" name="photographerName" required>
                                <option value="">Select Photographer</option>
                                <option value="Self">Self</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="photographerSalary">Photographer Salary (₹)</label>
                            <input type="number" id="photographerSalary" name="photographerSalary">
                        </div>
                        <div class="form-group">
                            <label for="eventDuration">Event Duration (Days)</label>
                            <input type="number" id="eventDuration" name="eventDuration" min="1" value="1">
                        </div>
                        <div class="form-group">
                            <label for="eventType">Event Type</label>
                            <select id="eventType" name="eventType" required>
                                <option value="">Select Type</option>
                                <option value="Wedding">Wedding</option>
                                <option value="Pre-Wedding">Pre-Wedding</option>
                                <option value="Birthday">Birthday</option>
                                <option value="Corporate">Corporate</option>
                                <option value="Fashion">Fashion</option>
                                <option value="Portrait">Portrait</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group" style="margin-top: 20px;">
                        <label for="eventNotes">Notes</label>
                        <textarea id="eventNotes" name="eventNotes" rows="3" placeholder="Additional notes about the event..."></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit" class="btn btn-primary">Add Event</button>
                        <button type="button" class="btn btn-secondary" onclick="clearForm()">Clear Form</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- View Events Tab -->
        <div id="events" class="tab-content">
            <div class="form-section">
                <h3>All Events</h3>
                <div style="margin-bottom: 20px;">
                    <input type="text" id="searchEvents" placeholder="Search events..." style="padding: 10px; width: 300px; border: 1px solid #ddd; border-radius: 5px;">
                    <select id="filterType" style="padding: 10px; margin-left: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <option value="">All Types</option>
                        <option value="Wedding">Wedding</option>
                        <option value="Pre-Wedding">Pre-Wedding</option>
                        <option value="Birthday">Birthday</option>
                        <option value="Corporate">Corporate</option>
                        <option value="Fashion">Fashion</option>
                        <option value="Portrait">Portrait</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <table class="data-table" id="eventsTable">
                    <thead>
                        <tr>
                            <th>Event Name</th>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Prize</th>
                            <th>Expenses</th>
                            <th>Photographer</th>
                            <th>Salary</th>
                            <th>Duration</th>
                            <th>Profit</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="eventsTableBody">
                        <tr>
                            <td colspan="10" style="text-align: center; color: #666;">No events found</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Photographers Tab -->
        <div id="photographers" class="tab-content">
            <div class="form-section">
                <h3>Add Photographer</h3>
                <form id="photographerForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="photographerNameAdd">Photographer Name</label>
                            <input type="text" id="photographerNameAdd" name="photographerNameAdd" required>
                        </div>
                        <div class="form-group">
                            <label for="photographerContact">Contact Number</label>
                            <input type="tel" id="photographerContact" name="photographerContact">
                        </div>
                        <div class="form-group">
                            <label for="photographerEmail">Email</label>
                            <input type="email" id="photographerEmail" name="photographerEmail">
                        </div>
                        <div class="form-group">
                            <label for="photographerRate">Daily Rate (₹)</label>
                            <input type="number" id="photographerRate" name="photographerRate">
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit" class="btn btn-primary">Add Photographer</button>
                    </div>
                </form>
            </div>
            
            <div class="form-section">
                <h3>Photographers List</h3>
                <table class="data-table" id="photographersTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Contact</th>
                            <th>Email</th>
                            <th>Daily Rate</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="photographersTableBody">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #666;">No photographers found</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Average Event Value</h4>
                    <div class="value" id="avgEventValue">₹0</div>
                </div>
                <div class="stat-card">
                    <h4>This Month Revenue</h4>
                    <div class="value" id="monthRevenue">₹0</div>
                </div>
                <div class="stat-card">
                    <h4>Most Popular Event Type</h4>
                    <div class="value" id="popularEventType">-</div>
                </div>
                <div class="stat-card">
                    <h4>Total Event Days</h4>
                    <div class="value" id="totalEventDays">0</div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Monthly Revenue Analysis</h3>
                <canvas id="revenueChart" width="400" height="200"></canvas>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="form-section">
                <h3>Google Sheets Integration</h3>
                <div class="google-sheets-section">
                    <h4>Connection Status: <span class="status-indicator status-disconnected" id="connectionStatus">Disconnected</span></h4>
                    
                    <div class="warning-box">
                        <h5>⚠️ Important Notice</h5>
                        <p>When connecting to Google Sheets for the first time, your local data will be preserved. The system will first upload your existing data to the sheet before enabling synchronization.</p>
                    </div>
                    
                    <p>To connect with Google Sheets, you'll need to:</p>
                    <ol>
                        <li>Create a Google Sheet for your business data</li>
                        <li>Set up Google Apps Script (copy the provided script)</li>
                        <li>Deploy as web app (Execute as: Me, Who has access: Anyone)</li>
                        <li>Enter the web app URL below</li>
                    </ol>
                    <div class="form-group" style="margin-top: 15px;">
                        <label for="googleSheetUrl">Google Apps Script Web App URL</label>
                        <input type="url" id="googleSheetUrl" placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec">
                    </div>
                    
                    <div class="sync-options">
                        <button class="btn btn-primary" onclick="connectGoogleSheets()">Connect & Upload Data</button>
                        <button class="btn btn-secondary" onclick="syncToGoogleSheets(true)" id="manualSyncBtn" disabled>Manual Sync</button>
                        <button class="btn btn-secondary" onclick="loadFromGoogleSheets()" id="loadFromSheetsBtn" disabled>Load from Sheets</button>
                        <button class="btn btn-danger" onclick="disconnectGoogleSheets()">Disconnect</button>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Data Management</h3>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="exportData()">Export Data</button>
                    <button class="btn btn-secondary" onclick="importData()">Import Data</button>
                    <button class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
                </div>
            </div>
        </div>

        <div id="salary-management" class="tab-content">
    <div class="form-section">
        <h3>Photographer Attendance & Salary</h3>
        <form id="attendanceForm">
            <div class="form-grid">
                <div class="form-group">
                    <label for="attendancePhotographer">Photographer</label>
                    <select id="attendancePhotographer" name="attendancePhotographer" required>
                        <option value="">Select Photographer</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="attendanceDate">Date</label>
                    <input type="date" id="attendanceDate" name="attendanceDate" required>
                </div>
                <div class="form-group">
                    <label for="attendanceStatus">Status</label>
                    <select id="attendanceStatus" name="attendanceStatus" required>
                        <option value="">Select Status</option>
                        <option value="Present">Present</option>
                        <option value="Absent">Absent</option>
                        <option value="Half-Day">Half-Day</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="attendanceNotes">Notes</label>
                    <input type="text" id="attendanceNotes" name="attendanceNotes" placeholder="Optional notes">
                </div>
            </div>
            <div class="action-buttons">
                <button type="submit" class="btn btn-primary">Mark Attendance</button>
                <button type="button" class="btn btn-secondary" onclick="document.getElementById('attendanceForm').reset()">Clear</button>
            </div>
        </form>
    </div>

    <div class="form-section">
        <h3>Salary Payment</h3>
        <form id="salaryPaymentForm">
            <div class="form-grid">
                <div class="form-group">
                    <label for="paymentPhotographer">Photographer</label>
                    <select id="paymentPhotographer" name="paymentPhotographer" required>
                        <option value="">Select Photographer</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="paymentAmount">Payment Amount (₹)</label>
                    <input type="number" id="paymentAmount" name="paymentAmount" required>
                </div>
                <div class="form-group">
                    <label for="paymentDate">Payment Date</label>
                    <input type="date" id="paymentDate" name="paymentDate" required>
                </div>
                <div class="form-group">
                    <label for="paymentMode">Payment Mode</label>
                    <select id="paymentMode" name="paymentMode" required>
                        <option value="">Select Mode</option>
                        <option value="Cash">Cash</option>
                        <option value="UPI">UPI</option>
                        <option value="Bank Transfer">Bank Transfer</option>
                        <option value="Cheque">Cheque</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="paymentRemarks">Remarks</label>
                    <input type="text" id="paymentRemarks" name="paymentRemarks" placeholder="Optional remarks">
                </div>
            </div>
            <div class="action-buttons">
                <button type="submit" class="btn btn-primary">Record Payment</button>
                <button type="button" class="btn btn-secondary" onclick="document.getElementById('salaryPaymentForm').reset()">Clear</button>
            </div>
        </form>
    </div>

    <div class="form-section">
        <h3>Attendance Records</h3>
        <div style="margin-bottom: 20px;">
            <select id="attendanceFilterPhotographer" style="padding: 10px; margin-right: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <option value="">All Photographers</option>
            </select>
            <input type="month" id="attendanceFilterMonth" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
        </div>
        <table class="data-table" id="attendanceTable">
            <thead>
                <tr>
                    <th>Photographer</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Daily Rate</th>
                    <th>Earnings</th>
                    <th>Notes</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="attendanceTableBody">
                <tr>
                    <td colspan="7" style="text-align: center; color: #666;">No attendance records found</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Expense Tracker Tab -->
<div id="expense-tracker" class="tab-content">
    <div class="form-section">
        <h3>Add Expense</h3>
        <form id="expenseForm">
            <div class="form-grid">
                <div class="form-group">
                    <label for="expenseDate">Date</label>
                    <input type="date" id="expenseDate" name="expenseDate" required>
                </div>
                <div class="form-group">
                    <label for="expenseCategory">Category</label>
                    <select id="expenseCategory" name="expenseCategory" required>
                        <option value="">Select Category</option>
                        <option value="Travel">Travel</option>
                        <option value="Equipment">Equipment</option>
                        <option value="Props">Props</option>
                        <option value="Food">Food</option>
                        <option value="Editing Tools">Editing Tools</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Miscellaneous">Miscellaneous</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="expenseDescription">Description</label>
                    <input type="text" id="expenseDescription" name="expenseDescription" required placeholder="Brief description">
                </div>
                <div class="form-group">
                    <label for="expenseAmount">Amount (₹)</label>
                    <input type="number" id="expenseAmount" name="expenseAmount" required>
                </div>
                <div class="form-group">
                    <label for="expensePaymentMode">Payment Mode</label>
                    <select id="expensePaymentMode" name="expensePaymentMode" required>
                        <option value="">Select Mode</option>
                        <option value="Cash">Cash</option>
                        <option value="UPI">UPI</option>
                        <option value="Bank Transfer">Bank Transfer</option>
                        <option value="Credit Card">Credit Card</option>
                        <option value="Debit Card">Debit Card</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="expenseRemarks">Remarks</label>
                    <input type="text" id="expenseRemarks" name="expenseRemarks" placeholder="Optional remarks">
                </div>
            </div>
            <div class="action-buttons">
                <button type="submit" class="btn btn-primary">Add Expense</button>
                <button type="button" class="btn btn-secondary" onclick="document.getElementById('expenseForm').reset()">Clear</button>
            </div>
        </form>
    </div>

    <div class="form-section">
        <h3>Expense Records</h3>
        <div style="margin-bottom: 20px;">
            <select id="expenseFilterCategory" style="padding: 10px; margin-right: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <option value="">All Categories</option>
                <option value="Travel">Travel</option>
                <option value="Equipment">Equipment</option>
                <option value="Props">Props</option>
                <option value="Food">Food</option>
                <option value="Editing Tools">Editing Tools</option>
                <option value="Marketing">Marketing</option>
                <option value="Miscellaneous">Miscellaneous</option>
            </select>
            <input type="month" id="expenseFilterMonth" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
        </div>
        <table class="data-table" id="expenseTable">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Category</th>
                    <th>Description</th>
                    <th>Amount</th>
                    <th>Payment Mode</th>
                    <th>Remarks</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="expenseTableBody">
                <tr>
                    <td colspan="7" style="text-align: center; color: #666;">No expense records found</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Salary Dashboard Tab -->
<div id="salary-dashboard" class="tab-content">
    <div class="stats-grid">
        <div class="stat-card">
            <h4>Total Salary Earned</h4>
            <div class="value" id="totalSalaryEarned">₹0</div>
        </div>
        <div class="stat-card">
            <h4>Total Salary Paid</h4>
            <div class="value" id="totalSalaryPaid">₹0</div>
        </div>
        <div class="stat-card">
            <h4>Outstanding Salary</h4>
            <div class="value" id="outstandingSalary">₹0</div>
        </div>
        <div class="stat-card">
            <h4>Total Expenses</h4>
            <div class="value" id="totalExpensesAmount">₹0</div>
        </div>
    </div>

    <div class="form-section">
        <h3>Photographer Salary Summary</h3>
        <table class="data-table" id="salaryDashboardTable">
            <thead>
                <tr>
                    <th>Photographer</th>
                    <th>Days Worked</th>
                    <th>Total Earned</th>
                    <th>Total Paid</th>
                    <th>Outstanding</th>
                    <th>Last Payment</th>
                </tr>
            </thead>
            <tbody id="salaryDashboardTableBody">
                <tr>
                    <td colspan="6" style="text-align: center; color: #666;">No salary data found</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="form-section">
        <h3>Monthly Expense Breakdown</h3>
        <div class="expense-breakdown" id="expenseBreakdown">
            <p style="text-align: center; color: #666;">No expense data found</p>
            </div>
         </div>
       </div>
       <!-- Salary Management Tab -->
<div id="salary-management" class="tab-content">
    <h2>Salary Management</h2>
    
    <!-- Attendance Section -->
    <div class="card">
        <h3>Mark Attendance</h3>
        <form id="attendanceForm">
            <div class="form-group">
                <label>Photographer:</label>
                <select id="attendancePhotographer" name="attendancePhotographer" required>
                    <option value="">Select Photographer</option>
                </select>
            </div>
            <div class="form-group">
                <label>Date:</label>
                <input type="date" id="attendanceDate" name="attendanceDate" required>
            </div>
            <div class="form-group">
                <label>Status:</label>
                <select name="attendanceStatus" required>
                    <option value="">Select Status</option>
                    <option value="Present">Present</option>
                    <option value="Half-Day">Half-Day</option>
                    <option value="Absent">Absent</option>
                </select>
            </div>
            <div class="form-group">
                <label>Notes:</label>
                <textarea name="attendanceNotes" placeholder="Optional notes"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Mark Attendance</button>
        </form>
    </div>

    <!-- Salary Payment Section -->
    <div class="card">
        <h3>Record Salary Payment</h3>
        <form id="salaryPaymentForm">
            <div class="form-group">
                <label>Photographer:</label>
                <select id="paymentPhotographer" name="paymentPhotographer" required>
                    <option value="">Select Photographer</option>
                </select>
            </div>
            <div class="form-group">
                <label>Amount (₹):</label>
                <input type="number" name="paymentAmount" step="0.01" required>
            </div>
            <div class="form-group">
                <label>Payment Date:</label>
                <input type="date" id="paymentDate" name="paymentDate" required>
            </div>
            <div class="form-group">
                <label>Payment Mode:</label>
                <select name="paymentMode" required>
                    <option value="">Select Mode</option>
                    <option value="Cash">Cash</option>
                    <option value="UPI">UPI</option>
                    <option value="Bank Transfer">Bank Transfer</option>
                    <option value="Cheque">Cheque</option>
                </select>
            </div>
            <div class="form-group">
                <label>Remarks:</label>
                <textarea name="paymentRemarks" placeholder="Optional remarks"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Record Payment</button>
        </form>
    </div>

    <!-- Attendance Table -->
    <div class="card">
        <h3>Attendance Records</h3>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Photographer</th>
                        <th>Date</th>
                        <th>Status</th>
                        <th>Daily Rate</th>
                        <th>Earnings</th>
                        <th>Notes</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="attendanceTableBody">
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Expense Tracker Tab -->
<div id="expense-tracker" class="tab-content">
    <h2>Expense Tracker</h2>
    
    <div class="card">
        <h3>Add Expense</h3>
        <form id="expenseForm">
            <div class="form-group">
                <label>Date:</label>
                <input type="date" id="expenseDate" name="expenseDate" required>
            </div>
            <div class="form-group">
                <label>Category:</label>
                <select name="expenseCategory" required>
                    <option value="">Select Category</option>
                    <option value="Travel">Travel</option>
                    <option value="Equipment">Equipment</option>
                    <option value="Props">Props</option>
                    <option value="Food">Food</option>
                    <option value="Editing Tools">Editing Tools</option>
                    <option value="Marketing">Marketing</option>
                    <option value="Maintenance">Maintenance</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label>Description:</label>
                <input type="text" name="expenseDescription" placeholder="Brief description" required>
            </div>
            <div class="form-group">
                <label>Amount (₹):</label>
                <input type="number" name="expenseAmount" step="0.01" required>
            </div>
            <div class="form-group">
                <label>Payment Mode:</label>
                <select name="expensePaymentMode" required>
                    <option value="">Select Mode</option>
                    <option value="Cash">Cash</option>
                    <option value="UPI">UPI</option>
                    <option value="Bank Transfer">Bank Transfer</option>
                    <option value="Credit Card">Credit Card</option>
                    <option value="Debit Card">Debit Card</option>
                </select>
            </div>
            <div class="form-group">
                <label>Remarks:</label>
                <textarea name="expenseRemarks" placeholder="Optional remarks"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Add Expense</button>
        </form>
    </div>

    <div class="card">
        <h3>Expense Records</h3>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Category</th>
                        <th>Description</th>
                        <th>Amount</th>
                        <th>Payment Mode</th>
                        <th>Remarks</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="expenseTableBody">
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Salary Dashboard Tab -->
<div id="salary-dashboard" class="tab-content">
    <h2>Salary Dashboard</h2>
    
    <!-- Summary Cards -->
    <div class="dashboard-grid">
        <div class="card">
            <h3>Total Salary Earned</h3>
            <div class="metric" id="totalSalaryEarned">₹0</div>
        </div>
        <div class="card">
            <h3>Total Salary Paid</h3>
            <div class="metric" id="totalSalaryPaid">₹0</div>
        </div>
        <div class="card">
            <h3>Outstanding Salary</h3>
            <div class="metric" id="outstandingSalary">₹0</div>
        </div>
        <div class="card">
            <h3>Total Expenses</h3>
            <div class="metric" id="totalExpensesAmount">₹0</div>
        </div>
    </div>

    <!-- Photographer Salary Summary -->
    <div class="card">
        <h3>Photographer Salary Summary</h3>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Photographer</th>
                        <th>Days Worked</th>
                        <th>Total Earned</th>
                        <th>Total Paid</th>
                        <th>Outstanding</th>
                        <th>Last Payment</th>
                    </tr>
                </thead>
                <tbody id="salaryDashboardTableBody">
                </tbody>
            </table>
        </div>
    </div>

    <!-- Expense Breakdown -->
    <div class="card">
        <h3>Expense Breakdown</h3>
        <div id="expenseBreakdown"></div>
    </div>
</div>
<script>
            // ===== ENHANCED PHOTOGRAPHY BUSINESS MANAGER - JAVASCRIPT =====
// Professional Photography Business Management System
// Compatible with Google Apps Script backend integration

class PhotographyBusinessManager {
    constructor() {
        this.events = JSON.parse(localStorage.getItem('events') || '[]');
        this.photographers = JSON.parse(localStorage.getItem('photographers') || '[]');
        this.attendanceRecords = JSON.parse(localStorage.getItem('attendance') || '[]');
        this.expenseRecords = JSON.parse(localStorage.getItem('expenses') || '[]');
        this.paymentHistory = JSON.parse(localStorage.getItem('payments') || '[]');
        this.salaryData = JSON.parse(localStorage.getItem('salaryData') || '{}');
        
        // Configuration
        this.config = {
            googleSheetUrl: localStorage.getItem('googleSheetUrl') || '',
            autoSync: localStorage.getItem('autoSync') === 'true',
            currency: 'INR',
            currencySymbol: '₹',
            reportEmail: localStorage.getItem('reportEmail') || '',
            darkMode: localStorage.getItem('darkMode') === 'true',
            notifications: localStorage.getItem('notifications') !== 'false'
        };
        
        // Initialize default photographer if none exists
        if (this.photographers.length === 0) {
            this.addDefaultPhotographer();
        }
        
        this.initializeEventHandlers();
        this.loadDashboard();
        this.setupPeriodicSync();
    }

    // ===== INITIALIZATION =====
    initializeEventHandlers() {
        // Event Management
        document.getElementById('addEventBtn')?.addEventListener('click', () => this.showEventModal());
        document.getElementById('saveEventBtn')?.addEventListener('click', () => this.saveEvent());
        document.getElementById('saveEventUpcomingBtn')?.addEventListener('click', () => this.saveEventUpcoming());
        
        // Photographer Management
        document.getElementById('addPhotographerBtn')?.addEventListener('click', () => this.showPhotographerModal());
        document.getElementById('savePhotographerBtn')?.addEventListener('click', () => this.savePhotographer());
        
        // Attendance Management
        document.getElementById('addAttendanceBtn')?.addEventListener('click', () => this.showAttendanceModal());
        document.getElementById('saveAttendanceBtn')?.addEventListener('click', () => this.saveAttendance());
        
        // Expense Management
        document.getElementById('addExpenseBtn')?.addEventListener('click', () => this.showExpenseModal());
        document.getElementById('saveExpenseBtn')?.addEventListener('click', () => this.saveExpense());
        
        // Salary Management
        document.getElementById('addPaymentBtn')?.addEventListener('click', () => this.showPaymentModal());
        document.getElementById('savePaymentBtn')?.addEventListener('click', () => this.savePayment());
        
        // Settings and Sync
        document.getElementById('syncBtn')?.addEventListener('click', () => this.syncWithGoogleSheets());
        document.getElementById('settingsBtn')?.addEventListener('click', () => this.showSettingsModal());
        document.getElementById('saveSettingsBtn')?.addEventListener('click', () => this.saveSettings());
        
        // Export functionality
        document.getElementById('exportBtn')?.addEventListener('click', () => this.showExportModal());
        document.getElementById('exportDataBtn')?.addEventListener('click', () => this.exportData());
        
        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const target = e.target.getAttribute('data-target');
                this.showSection(target);
            });
        });
        
        // Modal close handlers
        document.querySelectorAll('.modal .close').forEach(closeBtn => {
            closeBtn.addEventListener('click', (e) => {
                e.target.closest('.modal').style.display = 'none';
            });
        });
        
        // Click outside modal to close
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });
        
        // Auto-calculate profit in event form
        document.getElementById('eventPrize')?.addEventListener('input', () => this.calculateEventProfit());
        document.getElementById('eventExpenses')?.addEventListener('input', () => this.calculateEventProfit());
        document.getElementById('eventSalary')?.addEventListener('input', () => this.calculateEventProfit());
        
        // Auto-calculate earnings in attendance form
        document.getElementById('attendanceDailyRate')?.addEventListener('input', () => this.calculateAttendanceEarnings());
        document.getElementById('attendanceStatus')?.addEventListener('change', () => this.calculateAttendanceEarnings());
        
        // Search functionality
        document.getElementById('searchInput')?.addEventListener('input', (e) => this.searchRecords(e.target.value));
        
        // Theme toggle
        document.getElementById('themeToggle')?.addEventListener('click', () => this.toggleTheme());
    }

    addDefaultPhotographer() {
        const defaultPhotographer = {
            id: 1,
            name: 'Self',
            contact: '',
            email: '',
            rate: 0,
            createdAt: new Date().toISOString()
        };
        this.photographers.push(defaultPhotographer);
        this.saveToLocalStorage();
    }

    // ===== EVENT MANAGEMENT =====
    showEventModal(eventId = null) {
        const modal = document.getElementById('eventModal');
        const form = document.getElementById('eventForm');
        const titleElement = document.getElementById('eventModalTitle');
        
        if (eventId) {
            const event = this.events.find(e => e.id === eventId);
            if (event) {
                titleElement.textContent = 'Edit Event';
                this.populateEventForm(event);
            }
        } else {
            titleElement.textContent = 'Add New Event';
            form.reset();
            document.getElementById('eventId').value = '';
        }
        
        this.populatePhotographerDropdown('eventPhotographer');
        modal.style.display = 'block';
    }

    populateEventForm(event) {
        document.getElementById('eventId').value = event.id;
        document.getElementById('eventName').value = event.name;
        document.getElementById('eventDate').value = event.date;
        document.getElementById('eventType').value = event.type;
        document.getElementById('eventPrize').value = event.prize;
        document.getElementById('eventExpenses').value = event.expenses;
        document.getElementById('eventPhotographer').value = event.photographer;
        document.getElementById('eventSalary').value = event.salary;
        document.getElementById('eventDuration').value = event.duration;
        document.getElementById('eventNotes').value = event.notes || '';
        this.calculateEventProfit();
    }

    saveEvent() {
        const formData = new FormData(document.getElementById('eventForm'));
        const eventData = {
            id: formData.get('eventId') || Date.now(),
            name: formData.get('eventName'),
            date: formData.get('eventDate'),
            type: formData.get('eventType'),
            prize: parseFloat(formData.get('eventPrize')) || 0,
            expenses: parseFloat(formData.get('eventExpenses')) || 0,
            photographer: formData.get('eventPhotographer'),
            salary: parseFloat(formData.get('eventSalary')) || 0,
            duration: parseInt(formData.get('eventDuration')) || 1,
            notes: formData.get('eventNotes') || '',
            profit: 0,
            status: 'completed',
            createdAt: new Date().toISOString()
        };
        
        eventData.profit = eventData.prize - eventData.expenses - eventData.salary;
        
        const existingIndex = this.events.findIndex(e => e.id === eventData.id);
        if (existingIndex !== -1) {
            this.events[existingIndex] = eventData;
        } else {
            this.events.push(eventData);
        }
        
        this.saveToLocalStorage();
        this.refreshEventTables();
        this.updateSalaryData();
        document.getElementById('eventModal').style.display = 'none';
        this.showNotification('Event saved successfully!', 'success');
        
        if (this.config.autoSync && this.config.googleSheetUrl) {
            this.syncWithGoogleSheets();
        }
    }

    saveEventUpcoming() {
        const formData = new FormData(document.getElementById('eventForm'));
        const eventData = {
            id: formData.get('eventId') || Date.now(),
            name: formData.get('eventName'),
            date: formData.get('eventDate'),
            type: formData.get('eventType'),
            prize: parseFloat(formData.get('eventPrize')) || 0,
            expenses: 0,
            photographer: formData.get('eventPhotographer'),
            salary: 0,
            duration: parseInt(formData.get('eventDuration')) || 1,
            notes: formData.get('eventNotes') || '',
            profit: 0,
            status: 'upcoming',
            createdAt: new Date().toISOString()
        };
        
        const existingIndex = this.events.findIndex(e => e.id === eventData.id);
        if (existingIndex !== -1) {
            this.events[existingIndex] = eventData;
        } else {
            this.events.push(eventData);
        }
        
        this.saveToLocalStorage();
        this.refreshEventTables();
        document.getElementById('eventModal').style.display = 'none';
        this.showNotification('Upcoming event saved successfully!', 'success');
        
        if (this.config.autoSync && this.config.googleSheetUrl) {
            this.syncWithGoogleSheets();
        }
    }

    deleteEvent(eventId) {
        if (confirm('Are you sure you want to delete this event?')) {
            this.events = this.events.filter(e => e.id !== eventId);
            this.saveToLocalStorage();
            this.refreshEventTables();
            this.updateSalaryData();
            this.showNotification('Event deleted successfully!', 'success');
            
            if (this.config.autoSync && this.config.googleSheetUrl) {
                this.syncWithGoogleSheets();
            }
        }
    }

    calculateEventProfit() {
        const prize = parseFloat(document.getElementById('eventPrize').value) || 0;
        const expenses = parseFloat(document.getElementById('eventExpenses').value) || 0;
        const salary = parseFloat(document.getElementById('eventSalary').value) || 0;
        const profit = prize - expenses - salary;
        
        const profitDisplay = document.getElementById('eventProfitDisplay');
        if (profitDisplay) {
            profitDisplay.textContent = `${this.config.currencySymbol}${profit.toFixed(2)}`;
            profitDisplay.className = profit >= 0 ? 'profit-positive' : 'profit-negative';
        }
    }

    // ===== PHOTOGRAPHER MANAGEMENT =====
    showPhotographerModal(photographerId = null) {
        const modal = document.getElementById('photographerModal');
        const form = document.getElementById('photographerForm');
        const titleElement = document.getElementById('photographerModalTitle');
        
        if (photographerId) {
            const photographer = this.photographers.find(p => p.id === photographerId);
            if (photographer) {
                titleElement.textContent = 'Edit Photographer';
                this.populatePhotographerForm(photographer);
            }
        } else {
            titleElement.textContent = 'Add New Photographer';
            form.reset();
            document.getElementById('photographerId').value = '';
        }
        
        modal.style.display = 'block';
    }

    populatePhotographerForm(photographer) {
        document.getElementById('photographerId').value = photographer.id;
        document.getElementById('photographerName').value = photographer.name;
        document.getElementById('photographerContact').value = photographer.contact;
        document.getElementById('photographerEmail').value = photographer.email || '';
        document.getElementById('photographerRate').value = photographer.rate;
    }

    savePhotographer() {
        const formData = new FormData(document.getElementById('photographerForm'));
        const photographerData = {
            id: formData.get('photographerId') || Date.now(),
            name: formData.get('photographerName'),
            contact: formData.get('photographerContact'),
            email: formData.get('photographerEmail') || '',
            rate: parseFloat(formData.get('photographerRate')) || 0,
            createdAt: new Date().toISOString()
        };
        
        const existingIndex = this.photographers.findIndex(p => p.id === photographerData.id);
        if (existingIndex !== -1) {
            this.photographers[existingIndex] = photographerData;
        } else {
            this.photographers.push(photographerData);
        }
        
        this.saveToLocalStorage();
        this.refreshPhotographerTable();
        this.populatePhotographerDropdowns();
        document.getElementById('photographerModal').style.display = 'none';
        this.showNotification('Photographer saved successfully!', 'success');
        
        if (this.config.autoSync && this.config.googleSheetUrl) {
            this.syncWithGoogleSheets();
        }
    }

    deletePhotographer(photographerId) {
        if (photographerId === 1) {
            this.showNotification('Cannot delete the default "Self" photographer!', 'error');
            return;
        }
        
        if (confirm('Are you sure you want to delete this photographer?')) {
            this.photographers = this.photographers.filter(p => p.id !== photographerId);
            this.saveToLocalStorage();
            this.refreshPhotographerTable();
            this.populatePhotographerDropdowns();
            this.showNotification('Photographer deleted successfully!', 'success');
            
            if (this.config.autoSync && this.config.googleSheetUrl) {
                this.syncWithGoogleSheets();
            }
        }
    }

    // ===== ATTENDANCE MANAGEMENT =====
    showAttendanceModal(recordId = null) {
        const modal = document.getElementById('attendanceModal');
        const form = document.getElementById('attendanceForm');
        const titleElement = document.getElementById('attendanceModalTitle');
        
        if (recordId) {
            const record = this.attendanceRecords.find(r => r.id === recordId);
            if (record) {
                titleElement.textContent = 'Edit Attendance';
                this.populateAttendanceForm(record);
            }
        } else {
            titleElement.textContent = 'Record Attendance';
            form.reset();
            document.getElementById('attendanceId').value = '';
            document.getElementById('attendanceDate').value = new Date().toISOString().split('T')[0];
        }
        
        this.populatePhotographerDropdown('attendancePhotographer');
        modal.style.display = 'block';
    }

    populateAttendanceForm(record) {
        document.getElementById('attendanceId').value = record.id;
        document.getElementById('attendanceDate').value = record.date;
        document.getElementById('attendancePhotographer').value = record.photographerId;
        document.getElementById('attendanceStatus').value = record.status;
        document.getElementById('attendanceDailyRate').value = record.dailyRate;
        document.getElementById('attendanceNotes').value = record.notes || '';
        this.calculateAttendanceEarnings();
    }

    saveAttendance() {
        const formData = new FormData(document.getElementById('attendanceForm'));
        const photographerId = parseInt(formData.get('attendancePhotographer'));
        const photographer = this.photographers.find(p => p.id === photographerId);
        
        const attendanceData = {
            id: formData.get('attendanceId') || Date.now(),
            date: formData.get('attendanceDate'),
            photographerId: photographerId,
            photographerName: photographer ? photographer.name : 'Unknown',
            status: formData.get('attendanceStatus'),
            dailyRate: parseFloat(formData.get('attendanceDailyRate')) || 0,
            earnings: 0,
            notes: formData.get('attendanceNotes') || '',
            timestamp: new Date().toISOString()
        };
        
        // Calculate earnings based on status
        const baseEarnings = attendanceData.dailyRate;
        switch (attendanceData.status) {
            case 'present':
                attendanceData.earnings = baseEarnings;
                break;
            case 'half-day':
                attendanceData.earnings = baseEarnings * 0.5;
                break;
            case 'absent':
                attendanceData.earnings = 0;
                break;
            default:
                attendanceData.earnings = 0;
        }
        
        const existingIndex = this.attendanceRecords.findIndex(r => r.id === attendanceData.id);
        if (existingIndex !== -1) {
            this.attendanceRecords[existingIndex] = attendanceData;
        } else {
            this.attendanceRecords.push(attendanceData);
        }
        
        this.saveToLocalStorage();
        this.refreshAttendanceTable();
        this.updateSalaryData();
        document.getElementById('attendanceModal').style.display = 'none';
        this.showNotification('Attendance recorded successfully!', 'success');
        
        if (this.config.autoSync && this.config.googleSheetUrl) {
            this.syncWithGoogleSheets();
        }
    }

    deleteAttendance(recordId) {
        if (confirm('Are you sure you want to delete this attendance record?')) {
            this.attendanceRecords = this.attendanceRecords.filter(r => r.id !== recordId);
            this.saveToLocalStorage();
            this.refreshAttendanceTable();
            this.updateSalaryData();
            this.showNotification('Attendance record deleted successfully!', 'success');
            
            if (this.config.autoSync && this.config.googleSheetUrl) {
                this.syncWithGoogleSheets();
            }
        }
    }

    calculateAttendanceEarnings() {
        const dailyRate = parseFloat(document.getElementById('attendanceDailyRate').value) || 0;
        const status = document.getElementById('attendanceStatus').value;
        
        let earnings = 0;
        switch (status) {
            case 'present':
                earnings = dailyRate;
                break;
            case 'half-day':
                earnings = dailyRate * 0.5;
                break;
            case 'absent':
                earnings = 0;
                break;
        }
        
        const earningsDisplay = document.getElementById('attendanceEarningsDisplay');
        if (earningsDisplay) {
            earningsDisplay.textContent = `${this.config.currencySymbol}${earnings.toFixed(2)}`;
        }
    }

    // ===== EXPENSE MANAGEMENT =====
    showExpenseModal(expenseId = null) {
        const modal = document.getElementById('expenseModal');
        const form = document.getElementById('expenseForm');
        const titleElement = document.getElementById('expenseModalTitle');
        
        if (expenseId) {
            const expense = this.expenseRecords.find(e => e.id === expenseId);
            if (expense) {
                titleElement.textContent = 'Edit Expense';
                this.populateExpenseForm(expense);
            }
        } else {
            titleElement.textContent = 'Add New Expense';
            form.reset();
            document.getElementById('expenseId').value = '';
            document.getElementById('expenseDate').value = new Date().toISOString().split('T')[0];
        }
        
        modal.style.display = 'block';
    }

    populateExpenseForm(expense) {
        document.getElementById('expenseId').value = expense.id;
        document.getElementById('expenseDate').value = expense.date;
        document.getElementById('expenseCategory').value = expense.category;
        document.getElementById('expenseDescription').value = expense.description;
        document.getElementById('expenseAmount').value = expense.amount;
        document.getElementById('expensePaymentMode').value = expense.paymentMode;
        document.getElementById('expenseRemarks').value = expense.remarks || '';
    }

    saveExpense() {
        const formData = new FormData(document.getElementById('expenseForm'));
        const expenseData = {
            id: formData.get('expenseId') || Date.now(),
            date: formData.get('expenseDate'),
            category: formData.get('expenseCategory'),
            description: formData.get('expenseDescription'),
            amount: parseFloat(formData.get('expenseAmount')) || 0,
            paymentMode: formData.get('expensePaymentMode'),
            remarks: formData.get('expenseRemarks') || '',
            timestamp: new Date().toISOString()
        };
        
        const existingIndex = this.expenseRecords.findIndex(e => e.id === expenseData.id);
        if (existingIndex !== -1) {
            this.expenseRecords[existingIndex] = expenseData;
        } else {
            this.expenseRecords.push(expenseData);
        }
        
        this.saveToLocalStorage();
        this.refreshExpenseTable();
        this.updateDashboardMetrics();
        document.getElementById('expenseModal').style.display = 'none';
        this.showNotification('Expense saved successfully!', 'success');
        
        if (this.config.autoSync && this.config.googleSheetUrl) {
            this.syncWithGoogleSheets();
        }
    }

    deleteExpense(expenseId) {
        if (confirm('Are you sure you want to delete this expense?')) {
            this.expenseRecords = this.expenseRecords.filter(e => e.id !== expenseId);
            this.saveToLocalStorage();
            this.refreshExpenseTable();
            this.updateDashboardMetrics();
            this.showNotification('Expense deleted successfully!', 'success');
            
            if (this.config.autoSync && this.config.googleSheetUrl) {
                this.syncWithGoogleSheets();
            }
        }
    }

    // ===== SALARY MANAGEMENT =====
    showPaymentModal(photographerId = null) {
        const modal = document.getElementById('paymentModal');
        const form = document.getElementById('paymentForm');
        
        if (photographerId) {
            document.getElementById('paymentPhotographer').value = photographerId;
        }
        
        this.populatePhotographerDropdown('paymentPhotographer');
        document.getElementById('paymentDate').value = new Date().toISOString().split('T')[0];
        modal.style.display = 'block';
    }

    savePayment() {
        const formData = new FormData(document.getElementById('paymentForm'));
        const photographerId = parseInt(formData.get('paymentPhotographer'));
        const photographer = this.photographers.find(p => p.id === photographerId);
        
        const paymentData = {
            id: Date.now(),
            paymentDate: formData.get('paymentDate'),
            photographerId: photographerId,
            photographerName: photographer ? photographer.name : 'Unknown',
            amount: parseFloat(formData.get('paymentAmount')) || 0,
            paymentMode: formData.get('paymentMode'),
            remarks: formData.get('paymentRemarks') || '',
            timestamp: new Date().toISOString()
        };
        
        this.paymentHistory.push(paymentData);
        this.saveToLocalStorage();
        this.updateSalaryData();
        this.refreshSalaryTable();
        document.getElementById('paymentModal').style.display = 'none';
        this.showNotification('Payment recorded successfully!', 'success');
        
        if (this.config.autoSync && this.config.googleSheetUrl) {
            this.syncWithGoogleSheets();
        }
    }

    updateSalaryData() {
        const salaryData = {};
        
        // Calculate earnings from events
        this.events.forEach(event => {
            const photographerId = parseInt(event.photographer);
            if (!salaryData[photographerId]) {
                salaryData[photographerId] = {
                    totalEarned: 0,
                    totalPaid: 0,
                    daysWorked: 0,
                    lastPaymentDate: null
                };
            }
            salaryData[photographerId].totalEarned += event.salary || 0;
            salaryData[photographerId].daysWorked += event.duration || 0;
        });
        
        // Calculate earnings from attendance
        this.attendanceRecords.forEach(record => {
            const photographerId = record.photographerId;
            if (!salaryData[photographerId]) {
                salaryData[photographerId] = {
                    totalEarned: 0,
                    totalPaid: 0,
                    daysWorked: 0,
                    lastPaymentDate: null
                };
            }
            salaryData[photographerId].totalEarned += record.earnings || 0;
            if (record.status === 'present') {
                salaryData[photographerId].daysWorked += 1;
            } else if (record.status === 'half-day') {
                salaryData[photographerId].daysWorked += 0.5;
            }
        });
        
        // Calculate payments
        this.paymentHistory.forEach(payment => {
            const photographerId = payment.photographerId;
            if (!salaryData[photographerId]) {
                salaryData[photographerId] = {
                    totalEarned: 0,
                    totalPaid: 0,
                    daysWorked: 0,
                    lastPaymentDate: null
                };
            }
            salaryData[photographerId].totalPaid += payment.amount || 0;
            if (!salaryData[photographerId].lastPaymentDate || 
                payment.paymentDate > salaryData[photographerId].lastPaymentDate) {
                salaryData[photographerId].lastPaymentDate = payment.paymentDate;
            }
        });
        
        this.salaryData = salaryData;
        this.saveToLocalStorage();
    }

    // ===== GOOGLE SHEETS INTEGRATION =====
    async syncWithGoogleSheets() {
        if (!this.config.googleSheetUrl) {
            this.showNotification('Google Sheets URL not configured!', 'error');
            return;
        }
        
        try {
            this.showNotification('Syncing with Google Sheets...', 'info');
            
            const syncData = {
                action: 'sync',
                events: JSON.stringify(this.events),
                photographers: JSON.stringify(this.photographers),
                attendance: JSON.stringify(this.attendanceRecords),
                expenses: JSON.stringify(this.expenseRecords),
                payments: JSON.stringify(this.paymentHistory),
                salaryData: JSON.stringify(this.salaryData)
            };
            
            const response = await fetch(this.config.googleSheetUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams(syncData)
            });
            
            if (response.ok) {
                const result = await response.text();
                this.showNotification('Data synced successfully!', 'success');
                localStorage.setItem('lastSyncTime', new Date().toISOString());
            } else {
                throw new Error('Sync failed');
            }
        } catch (error) {
            console.error('Sync error:', error);
            this.showNotification('Sync failed. Please check your connection.', 'error');
        }
    }

    async loadFromGoogleSheets() {
        if (!this.config.googleSheetUrl) {
            this.showNotification('Google Sheets URL not configured!', 'error');
            return;
        }
        
        try {
            this.showNotification('Loading data from Google Sheets...', 'info');
            
            const response = await fetch(`${this.config.googleSheetUrl}?action=load`);
            
            if (response.ok) {
                const data = await response.json();
                
                if (data.events) this.events = data.events;
                if (data.photographers) this.photographers = data.photographers;
                if (data.attendance) this.attendanceRecords = data.attendance;
                if (data.expenses) this.expenseRecords = data.expenses;
                if (data.payments) this.paymentHistory = data.payments;
                if (data.salaryData) this.salaryData = data.salaryData;
                
                this.saveToLocalStorage();
                this.loadDashboard();
                this.showNotification('Data loaded successfully!', 'success');
            } else {
                throw new Error('Load failed');
            }
        } catch (error) {
            console.error('Load error:', error);
            this.showNotification('Failed to load data from Google Sheets.', 'error');
        }
    }

    // ===== UI MANAGEMENT =====
    showSection(sectionId) {
        // Hide all sections
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });
        
        // Show selected section
        const targetSection = document.getElementById(sectionId);
        if (targetSection) {
            targetSection.classList.add('active');
        }
        
        // Update navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
        });
        
        const activeLink = document.querySelector(`[data-target="${sectionId}"]`);
        if (activeLink) {
            activeLink.classList.add('active');
        }
        
        // Refresh section-specific data
        switch (sectionId) {
            case 'eventsSection':
                this.refreshEventTables();
                break;
            case 'photographersSection':
                this.refreshPhotographerTable();
                break;
            case 'attendanceSection':
                this.refreshAttendanceTable();
                break;
            case 'expensesSection':
                this.refreshExpenseTable();
                break;
            case 'salarySection':
                this.refreshSalaryTable();
                break;
            case 'dashboardSection':
                this.loadDashboard();
                break;
        }
    }
    showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.textContent = message;
        document.body.appendChild(notification);
        
        // Automatically remove notification after 5 seconds
        setTimeout(() => {
            notification.remove();
        }, 5000);
    }
    toggleTheme() {
        const body = document.body;
        body.classList.toggle('dark-mode');
        this.config.darkMode = body.classList.contains('dark-mode');
        localStorage.setItem('darkMode', this.config.darkMode);
        
        this.showNotification(`Theme switched to ${this.config.darkMode ? 'Dark' : 'Light'} mode`, 'info');
    }
    saveToLocalStorage() {
        localStorage.setItem('events', JSON.stringify(this.events));
        localStorage.setItem('photographers', JSON.stringify(this.photographers));
        localStorage.setItem('attendanceRecords', JSON.stringify(this.attendanceRecords));
        localStorage.setItem('expenses', JSON.stringify(this.expenseRecords));
        localStorage.setItem('payments', JSON.stringify(this.paymentHistory));
        localStorage.setItem('salaryData', JSON.stringify(this.salaryData));
    }
    loadDashboard() {
        // Load dashboard metrics and render summary
        this.updateDashboardMetrics();
        this.renderSummaryDashboard();
    }
    updateDashboardMetrics() {
        const totalEvents = this.events.length;
        const totalPhotographers = this.photographers.length;
        const totalAttendance = this.attendanceRecords.length;
        const totalExpenses = this.expenseRecords.reduce((sum, e) => sum + (e.amount || 0), 0);
        const totalPayments = this.paymentHistory.reduce((sum, p) => sum + (p.amount || 0), 0);
        const totalEarnings = Object.values(this.salaryData).reduce((sum, data) => sum + (data.totalEarned || 0), 0);
        const totalProfit = totalEarnings - totalExpenses - totalPayments;
        const lastSyncTime = localStorage.getItem('lastSyncTime') || 'Never';
        const dashboardMetrics = {
            totalEvents,
            totalPhotographers,
            totalAttendance,
            totalExpenses: `${this.config.currencySymbol}${totalExpenses.toFixed(2)}`,
            totalPayments: `${this.config.currencySymbol}${totalPayments.toFixed(2)}`,
            totalEarnings: `${this.config.currencySymbol}${totalEarnings.toFixed(2)}`,
            totalProfit: `${this.config.currencySymbol}${totalProfit.toFixed(2)}`,
            lastSyncTime
        };
        const dashboardElement = document.getElementById('dashboardMetrics');
        if (dashboardElement) {
            dashboardElement.innerHTML = `
                <h2>Dashboard Metrics</h2>
                <ul>
                    <li>Total Events: ${dashboardMetrics.totalEvents}</li>
                    <li>Total Photographers: ${dashboardMetrics.totalPhotographers}</li>
                    <li>Total Attendance Records: ${dashboardMetrics.totalAttendance}</li>
                    <li>Total Expenses: ${dashboardMetrics.totalExpenses}</li>
                    <li>Total Payments: ${dashboardMetrics.totalPayments}</li>
                    <li>Total Earnings: ${dashboardMetrics.totalEarnings}</li>
                    <li>Total Profit: ${dashboardMetrics.totalProfit}</li>
                    <li>Last Sync Time: ${dashboardMetrics.lastSyncTime}</li>
                </ul>
            `;
        }
    }
    renderSummaryDashboard() {
        const summaryElement = document.getElementById('summaryDashboard');
        if (!summaryElement) return;
        summaryElement.innerHTML = '';
        const totalEvents = this.events.length;
        const totalPhotographers = this.photographers.length;
        const totalAttendance = this.attendanceRecords.length;
        const totalExpenses = this.expenseRecords.reduce((sum, e) => sum + (e.amount || 0), 0);
        const totalPayments = this.paymentHistory.reduce((sum, p) => sum + (p.amount || 0), 0);
        const totalEarnings = Object.values(this.salaryData).reduce((sum, data) => sum + (data.totalEarned || 0), 0);
        const totalProfit = totalEarnings - totalExpenses - totalPayments;
        const lastSyncTime = localStorage.getItem('lastSyncTime') || 'Never';
        summaryElement.innerHTML = `
            <h2>Summary Dashboard</h2>
            <ul>
                <li>Total Events: ${totalEvents}</li>
                <li>Total Photographers: ${totalPhotographers}</li>
                <li>Total Attendance Records: ${totalAttendance}</li>
                <li>Total Expenses: ${this.config.currencySymbol}${totalExpenses.toFixed(2)}</li>
                <li>Total Payments: ${this.config.currencySymbol}${totalPayments.toFixed(2)}</li>
                <li>Total Earnings: ${this.config.currencySymbol}${totalEarnings.toFixed(2)}</li>
                <li>Total Profit: ${this.config.currencySymbol}${totalProfit.toFixed(2)}</li>
                <li>Last Sync Time: ${lastSyncTime}</li>
            </ul>
        `;
    }
    refreshEventTables() {
        const completedEventsTable = document.getElementById('completedEventsTable');
        const upcomingEventsTable = document.getElementById('upcomingEventsTable');
        if (completedEventsTable) {
            completedEventsTable.innerHTML = '';
            this.events.filter(e => e.status === 'completed').forEach(event => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${event.name}</td>
                    <td>${event.date}</td>
                    <td>${event.type}</td>
                    <td>${this.config.currencySymbol}${event.prize.toFixed(2)}</td>
                    <td>${this.config.currencySymbol}${event.expenses.toFixed(2)}</td>
                    <td>${event.photographerName}</td>
                    <td>${this.config.currencySymbol}${event.salary.toFixed(2)}</td>
                    <td>${event.duration} days</td>
                    <td>${event.profit >= 0 ? `<span class="profit-positive">${this.config.currencySymbol}${event.profit.toFixed(2)}</span>` : `<span class="profit-negative">${this.config.currencySymbol}${event.profit.toFixed(2)}</span>`}</td>
                    <td>
                        <button class="btn btn-primary" onclick="app.showEventModal(${event.id})">Edit</button>
                        <button class="btn btn-danger" onclick="app.deleteEvent(${event.id})">Delete</button>
                    </td>
                `;
                completedEventsTable.appendChild(row);
            });
        }
        if (upcomingEventsTable) {
            upcomingEventsTable.innerHTML = '';
            this.events.filter(e => e.status === 'upcoming').forEach(event => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${event.name}</td>
                    <td>${event.date}</td>
                    <td>${event.type}</td>
                    <td>${this.config.currencySymbol}${event.prize.toFixed(2)}</td>
                    <td>${event.photographerName}</td>
                    <td>${event.duration} days</td>
                    <td>
                        <button class="btn btn-primary" onclick="app.showEventModal(${event.id})">Edit</button>
                        <button class="btn btn-danger" onclick="app.deleteEvent(${event.id})">Delete</button>
                    </td>
                `;
                upcomingEventsTable.appendChild(row);
            });
        }
    }
    refreshPhotographerTable() {
        const photographerTable = document.getElementById('photographerTable');
        if (photographerTable) {
            photographerTable.innerHTML = '';
            this.photographers.forEach(photographer => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${photographer.name}</td>
                    <td>${photographer.contact}</td>
                    <td>${photographer.email || 'N/A'}</td>
                    <td>${this.config.currencySymbol}${photographer.rate.toFixed(2)}</td>
                    <td>
                        <button class="btn btn-primary" onclick="app.showPhotographerModal(${photographer.id})">Edit</button>
                        <button class="btn btn-danger" onclick="app.deletePhotographer(${photographer.id})">Delete</button>
                    </td>
                `;
                photographerTable.appendChild(row);
            });
        }
    }
    refreshAttendanceTable() {
        const attendanceTable = document.getElementById('attendanceTable');
        if (attendanceTable) {
            attendanceTable.innerHTML = '';
            this.attendanceRecords.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.date}</td>
                    <td>${record.photographerName}</td>
                    <td>${record.status}</td>
                    <td>${this.config.currencySymbol}${record.dailyRate.toFixed(2)}</td>
                    <td>${this.config.currencySymbol}${record.earnings.toFixed(2)}</td>
                    <td>
                        <button class="btn btn-primary" onclick="app.showAttendanceModal(${record.id})">Edit</button>
                        <button class="btn btn-danger" onclick="app.deleteAttendance(${record.id})">Delete</button>
                    </td>
                `;
                attendanceTable.appendChild(row);
            });
        }
    }
    refreshExpenseTable() {
        const expenseTable = document.getElementById('expenseTable');
        if (expenseTable) {
            expenseTable.innerHTML = '';
            this.expenseRecords.forEach(expense => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${expense.date}</td>
                    <td>${expense.category}</td>
                    <td>${expense.description}</td>
                    <td>${this.config.currencySymbol}${expense.amount.toFixed(2)}</td>
                    <td>${expense.paymentMode}</td>
                    <td>${expense.remarks || 'N/A'}</td>
                    <td>
                        <button class="btn btn-primary" onclick="app.showExpenseModal(${expense.id})">Edit</button>
                        <button class="btn btn-danger" onclick="app.deleteExpense(${expense.id})">Delete</button>
                    </td>
                `;
                expenseTable.appendChild(row);
            });
        }
    }
    refreshSalaryTable() {
        const salaryTable = document.getElementById('salaryTable');
        if (salaryTable) {
            salaryTable.innerHTML = '';
            Object.keys(this.salaryData).forEach(photographerId => {
                const data = this.salaryData[photographerId];
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${data.photographerName || 'Unknown'}</td>
                    <td>${data.totalEarned.toFixed(2)}</td>
                    <td>${data.totalPaid.toFixed(2)}</td>
                    <td>${data.daysWorked}</td>
                    <td>${data.lastPaymentDate || 'N/A'}</td>
                `;
                salaryTable.appendChild(row);
            });
        }
    }
    populatePhotographerDropdowns() {
        const photographerSelects = document.querySelectorAll('.photographer-select');
        photographerSelects.forEach(select => {
            select.innerHTML = '';
            this.photographers.forEach(photographer => {
                const option = document.createElement('option');
                option.value = photographer.id;
                option.textContent = photographer.name;
                select.appendChild(option);
            });
        });
    }
}
</script>

    </div>
</body>
</html>
