<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RN Studio - Business Manager</title>
 <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(255, 105, 180, 0.08) 0%, transparent 50%);
            min-height: 100vh;
            padding: 20px;
            color: #e5e7eb;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(17, 17, 17, 0.7);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 32px;
            box-shadow: 
                0 32px 64px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        }

        .header {
            text-align: center;
            margin-bottom: 48px;
            position: relative;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
            line-height: 1.1;
        }

        .header p {
            font-size: 1.1rem;
            color: #9ca3af;
            font-weight: 400;
            letter-spacing: 0.02em;
        }

        /* Mobile Navigation Wrapper */
        .mobile-nav-wrapper {
            position: relative;
            margin-bottom: 40px;
        }

        /* Hamburger Button */
        .hamburger-btn {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 1001;
        }

        .hamburger-btn:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: scale(1.05);
        }

        .hamburger-line {
            width: 24px;
            height: 3px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 2px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            margin: 2px 0;
        }

        .hamburger-btn.active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }

        .hamburger-btn.active .hamburger-line:nth-child(2) {
            opacity: 0;
            transform: scale(0);
        }

        .hamburger-btn.active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }

        /* Mobile Overlay */
        .mobile-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mobile-overlay.active {
            opacity: 1;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 8px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            flex-wrap: wrap;
            gap: 4px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-tab {
            padding: 14px 20px;
            background: transparent;
            border: none;
            border-radius: 14px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: #9ca3af;
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }

        .nav-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .nav-tab:hover::before {
            opacity: 1;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-1px);
            box-shadow: 
                0 8px 25px rgba(102, 126, 234, 0.3),
                0 0 0 1px rgba(255, 255, 255, 0.1);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-1px);
            color: #e5e7eb;
        }

        .tab-content {
            display: none;
            animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }

        .form-section {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            padding: 32px;
            border-radius: 20px;
            margin-bottom: 32px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
            overflow: hidden;
        }

        .form-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        }

        .form-section h3 {
            color: #f9fafb;
            margin-bottom: 28px;
            font-size: 1.5rem;
            font-weight: 600;
            position: relative;
            padding-bottom: 12px;
        }

        .form-section h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 2px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            padding: 32px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            border-color: rgba(255, 255, 255, 0.12);
        }

        .stat-card h4 {
            color: #9ca3af;
            font-size: 14px;
            margin-bottom: 16px;
            font-weight: 500;
            letter-spacing: 0.02em;
        }

        .stat-card .value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #f9fafb;
            letter-spacing: -0.02em;
            line-height: 1.1;
        }
        

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 24px;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .data-table th,
        .data-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 14px;
        }

        .data-table th {
            background: rgba(255, 255, 255, 0.05);
            color: #f9fafb;
            font-weight: 600;
            letter-spacing: 0.01em;
        }

        .data-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        /* Mobile Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 12px;
            }
            
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }

            .hamburger-btn {
                display: flex;
                margin-bottom: 20px;
            }

            .mobile-overlay {
                display: block;
            }

            .nav-tabs {
                position: fixed;
                top: 0;
                right: -100%;
                width: 280px;
                height: 100vh;
                flex-direction: column;
                justify-content: flex-start;
                align-items: stretch;
                background: rgba(17, 17, 17, 0.95);
                backdrop-filter: blur(20px);
                border-radius: 0;
                border: none;
                border-left: 1px solid rgba(255, 255, 255, 0.1);
                padding: 80px 24px 24px;
                gap: 8px;
                z-index: 1000;
                box-shadow: -10px 0 30px rgba(0, 0, 0, 0.5);
                transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .nav-tabs.active {
                right: 0;
            }

            .nav-tab {
                width: 100%;
                text-align: left;
                padding: 18px 24px;
                margin: 0;
                border-radius: 12px;
                font-size: 16px;
                font-weight: 500;
                transition: all 0.3s ease;
            }

            .nav-tab:hover:not(.active) {
                background: rgba(255, 255, 255, 0.08);
                transform: translateX(8px);
            }

            .nav-tab.active {
                transform: translateX(8px);
                box-shadow: 0 4px 20px rgba(102, 126, 234, 0.3);
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .stat-card {
                padding: 24px;
            }

            .stat-card .value {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .form-section {
                padding: 20px;
            }
            
            .nav-tabs {
                width: 100%;
                right: -100%;
                padding: 80px 20px 20px;
            }

            .nav-tab {
                padding: 16px 20px;
                font-size: 15px;
            }
        }

        /* Swipe gesture indicator */
        .swipe-indicator {
            position: fixed;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.3);
            font-size: 12px;
            writing-mode: vertical-lr;
            z-index: 1002;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        @media (min-width: 769px) {
            .swipe-indicator {
                display: none;
            }
        }

        /*  DeskTop Navigation Tabs */
        
        .nav-tabs {
    display: flex;
    justify-content: center;
    margin-bottom: 40px;
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 8px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    flex-wrap: wrap;
    gap: 4px;
}

.nav-tab {
    padding: 14px 20px;
    background: transparent;
    border: none;
    border-radius: 14px;
    cursor: pointer;
    font-weight: 500;
    font-size: 14px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    color: #9ca3af;
    position: relative;
    overflow: hidden;
    white-space: nowrap;
}

.nav-tab::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
    opacity: 0;
    transition: opacity 0.3s ease;
}

.nav-tab:hover::before {
    opacity: 1;
}

.nav-tab.active {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    transform: translateY(-1px);
    box-shadow: 
        0 8px 25px rgba(102, 126, 234, 0.3),
        0 0 0 1px rgba(255, 255, 255, 0.1);
}

.nav-tab:hover:not(.active) {
    background: rgba(255, 255, 255, 0.05);
    transform: translateY(-1px);
    color: #e5e7eb;
}

.tab-content {
    display: none;
    animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.tab-content.active {
    display: block;
}

@keyframes fadeInUp {
    from { 
        opacity: 0; 
        transform: translateY(30px);
    }
    to { 
        opacity: 1; 
        transform: translateY(0);
    }
}

.form-section {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    padding: 32px;
    border-radius: 20px;
    margin-bottom: 32px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    position: relative;
    overflow: hidden;
}

.form-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
}

.form-section h3 {
    color: #f9fafb;
    margin-bottom: 28px;
    font-size: 1.5rem;
    font-weight: 600;
    position: relative;
    padding-bottom: 12px;
}

.form-section h3::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 60px;
    height: 3px;
    background: linear-gradient(90deg, #667eea, #764ba2);
    border-radius: 2px;
}

.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 24px;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.form-group label {
    font-weight: 500;
    font-size: 14px;
    color: #d1d5db;
    letter-spacing: 0.01em;
}

.form-group input,
.form-group select,
.form-group textarea {
    padding: 16px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    font-size: 15px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    background: rgba(255, 255, 255, 0.05);
    color: #e5e7eb;
    font-family: inherit;
}

.form-group input::placeholder,
.form-group textarea::placeholder {
    color: #6b7280;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #667eea;
    background: rgba(255, 255, 255, 0.08);
    box-shadow: 
        0 0 0 3px rgba(102, 126, 234, 0.2),
        0 8px 25px rgba(0, 0, 0, 0.1);
    transform: translateY(-1px);
}

.form-group select option {
    background: #1f2937;
    color: #e5e7eb;
}

.btn {
    padding: 16px 32px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    letter-spacing: 0.01em;
    position: relative;
    overflow: hidden;
    font-family: inherit;
}

.btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transition: left 0.5s;
}

.btn:hover::before {
    left: 100%;
}

.btn-primary {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
}

.btn-secondary {
    background: rgba(255, 255, 255, 0.08);
    color: #e5e7eb;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.btn-secondary:hover {
    background: rgba(255, 255, 255, 0.12);
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

.btn-danger {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: white;
    box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
}

.btn-danger:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 24px;
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.data-table th,
.data-table td {
    padding: 16px;
    text-align: left;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    font-size: 14px;
}

.data-table th {
    background: rgba(255, 255, 255, 0.05);
    color: #f9fafb;
    font-weight: 600;
    letter-spacing: 0.01em;
}

.data-table tr:hover {
    background: rgba(255, 255, 255, 0.05);
}

.data-table tr:last-child td {
    border-bottom: none;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 24px;
    margin-bottom: 40px;
}

.stat-card {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    padding: 32px;
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    position: relative;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
}

.stat-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    border-color: rgba(255, 255, 255, 0.12);
}

.stat-card h4 {
    color: #9ca3af;
    font-size: 14px;
    margin-bottom: 16px;
    font-weight: 500;
    letter-spacing: 0.02em;
}

.stat-card .value {
    font-size: 2.5rem;
    font-weight: 700;
    color: #f9fafb;
    letter-spacing: -0.02em;
    line-height: 1.1;
}

.action-buttons {
    display: flex;
    gap: 16px;
    justify-content: center;
    margin-top: 32px;
    flex-wrap: wrap;
}

.google-sheets-section {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    padding: 28px;
    border-radius: 16px;
    margin-top: 24px;
    border: 1px solid rgba(102, 126, 234, 0.2);
    position: relative;
}

.google-sheets-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.3), transparent);
}

.google-sheets-section h4 {
    color: #667eea;
    margin-bottom: 20px;
    font-weight: 600;
}

.google-sheets-section h5 {
    color: #fbbf24;
    margin-bottom: 12px;
    font-weight: 600;
}

.google-sheets-section p,
.google-sheets-section li {
    color: #d1d5db;
    line-height: 1.6;
}

.google-sheets-section ol {
    margin-left: 20px;
    margin-bottom: 20px;
}

.warning-box {
    background: rgba(251, 191, 36, 0.1);
    border: 1px solid rgba(251, 191, 36, 0.2);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
}

.sync-options {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    margin-top: 20px;
}

.status-indicator {
    display: inline-block;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.02em;
}

.status-connected {
    background: rgba(34, 197, 94, 0.2);
    color: #22c55e;
    border: 1px solid rgba(34, 197, 94, 0.3);
}

.status-disconnected {
    background: rgba(239, 68, 68, 0.2);
    color: #ef4444;
    border: 1px solid rgba(239, 68, 68, 0.3);
}

.status-warning {
    background: rgba(251, 191, 36, 0.2);
    color: #fbbf24;
    border: 1px solid rgba(251, 191, 36, 0.3);
}

.expense-breakdown-grid {
    display: grid;
    gap: 20px;
    margin-top: 24px;
}

.expense-category {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    padding: 20px;
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.category-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.category-name {
    font-weight: 600;
    color: #f9fafb;
}

.category-amount {
    color: #667eea;
    font-weight: 600;
}

.category-bar {
    background: rgba(255, 255, 255, 0.05);
    height: 8px;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 8px;
}

.category-progress {
    background: linear-gradient(90deg, #667eea, #764ba2);
    height: 100%;
    border-radius: 4px;
    transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.category-percentage {
    text-align: right;
    font-size: 12px;
    color: #9ca3af;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 24px;
    margin-bottom: 40px;
}

.card {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    padding: 28px;
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    position: relative;
    overflow: hidden;
    margin-bottom: 24px;
}

.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
}

.card h3 {
    color: #f9fafb;
    margin-bottom: 24px;
    font-size: 1.3rem;
    font-weight: 600;
}

.card .metric {
    font-size: 2.5rem;
    font-weight: 700;
    color: #f9fafb;
    letter-spacing: -0.02em;
}

.table-responsive {
    overflow-x: auto;
    border-radius: 16px;
    margin-top: 20px;
}

.table-responsive table {
    min-width: 100%;
    white-space: nowrap;
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.table-responsive th,
.table-responsive td {
    padding: 16px;
    text-align: left;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    font-size: 14px;
}

.table-responsive th {
    background: rgba(255, 255, 255, 0.05);
    color: #f9fafb;
    font-weight: 600;
}

.table-responsive tr:hover {
    background: rgba(255, 255, 255, 0.05);
}

/* Search and filter inputs */
input[type="text"]:not(.form-group input),
input[type="month"]:not(.form-group input),
select:not(.form-group select) {
    padding: 12px 16px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.05);
    color: #e5e7eb;
    font-family: inherit;
    font-size: 14px;
    transition: all 0.3s ease;
}

input[type="text"]:not(.form-group input):focus,
input[type="month"]:not(.form-group input):focus,
select:not(.form-group select):focus {
    outline: none;
    border-color: #667eea;
    background: rgba(255, 255, 255, 0.08);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
}

input[type="text"]:not(.form-group input)::placeholder {
    color: #6b7280;
}

/* Custom scrollbar */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* Responsive design */
@media (max-width: 768px) {
    body {
        padding: 12px;
    }
    
    .container {
        padding: 24px;
    }
    
    .header h1 {
        font-size: 2.5rem;
    }
    
    .form-grid {
        grid-template-columns: 1fr;
    }
    
    .nav-tabs {
        flex-direction: column;
        gap: 8px;
    }
    
    .nav-tab {
        width: 100%;
        text-align: center;
    }
    
    .stats-grid,
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
    
    .action-buttons {
        flex-direction: column;
        align-items: center;
    }
    
    .sync-options {
        flex-direction: column;
    }
    
    .table-responsive {
        font-size: 13px;
    }
    
    .table-responsive th,
    .table-responsive td {
        padding: 12px 8px;
    }
}

@media (max-width: 480px) {
    .header h1 {
        font-size: 2rem;
    }
    
    .form-section {
        padding: 20px;
    }
    
    .stat-card {
        padding: 24px;
    }
    
    .stat-card .value {
        font-size: 2rem;
    }
}

/* Add subtle entrance animations */
.stat-card {
    animation: slideInUp 0.6s ease-out;
}

.stat-card:nth-child(2) {
    animation-delay: 0.1s;
}

.stat-card:nth-child(3) {
    animation-delay: 0.2s;
}

.stat-card:nth-child(4) {
    animation-delay: 0.3s;
}

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Enhanced focus states for accessibility */
.btn:focus,
.nav-tab:focus {
    outline: 2px solid #667eea;
    outline-offset: 2px;
}

/* Loading state for buttons */
.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

/* Enhance canvas styling for charts */
canvas {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

/* Mobile-specific enhancements */
@media (max-width: 768px) {
    .nav-tabs {
        z-index: 1000 !important;
    }
    
    .mobile-overlay {
        z-index: 999 !important;
    }
    
    .tab-content {
        padding: 15px 10px !important;
        overflow-y: auto !important;
        max-height: calc(100vh - 100px) !important;
    }
    
    .form-grid {
        grid-template-columns: 1fr !important;
        gap: 15px !important;
    }
    
    .data-table {
        overflow-x: auto !important;
        white-space: nowrap !important;
    }
    
    button, .btn {
        min-height: 44px !important;
        padding: 12px 20px !important;
        font-size: 16px !important;
    }
    
    input, select, textarea {
        min-height: 44px !important;
        font-size: 16px !important;
        padding: 12px !important;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>RN Studio</h1>
            <p>Professional Photography Business Manager</p>
        </div>

        <div class="mobile-nav-wrapper">
            <!-- Hamburger Button -->
            <div class="hamburger-btn" onclick="toggleMobileNav()">
                <div class="hamburger-line"></div>
                <div class="hamburger-line"></div>
                <div class="hamburger-line"></div>
            </div>

            <!-- Mobile Overlay -->
            <div class="mobile-overlay" onclick="closeMobileNav()"></div>

            <!-- Swipe Indicator -->
            <div class="swipe-indicator">Swipe ←</div>

            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab('dashboard')">Dashboard</button>
                <button class="nav-tab" onclick="showTab('add-event')">Add Event</button>
                <button class="nav-tab" onclick="showTab('events')">View Events</button>
                <button class="nav-tab" onclick="showTab('photographers')">Photographers</button>
                <button class="nav-tab" onclick="showTab('salary-management')">Salary Management</button>
                <button class="nav-tab" onclick="showTab('expense-tracker')">Expense Tracker</button>
                <button class="nav-tab" onclick="showTab('salary-dashboard')">Salary Dashboard</button>
                <button class="nav-tab" onclick="showTab('analytics')">Analytics</button>
                <button class="nav-tab" onclick="showTab('settings')">Settings</button>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Total Events</h4>
                    <div class="value" id="totalEvents">0</div>
                </div>
                <div class="stat-card">
                    <h4>Total Revenue</h4>
                    <div class="value" id="totalRevenue">₹0</div>
                </div>
                <div class="stat-card">
                    <h4>Total Expenses</h4>
                    <div class="value" id="totalExpenses">₹0</div>
                </div>
                <div class="stat-card">
                    <h4>Net Profit</h4>
                    <div class="value" id="netProfit">₹0</div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Recent Events</h3>
                <table class="data-table" id="recentEventsTable">
                    <thead>
                        <tr>
                            <th>Event Name</th>
                            <th>Date</th>
                            <th>Prize</th>
                            <th>Photographer</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="recentEventsBody">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #666;">No events found</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- Add Event Tab -->
        <div id="add-event" class="tab-content">
            <div class="form-section">
                <h3>Add New Event</h3>
                <form id="eventForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="eventName">Event Name</label>
                            <input type="text" id="eventName" name="eventName" required>
                        </div>
                        <div class="form-group">
                            <label for="eventDate">Event Date</label>
                            <input type="date" id="eventDate" name="eventDate" required>
                        </div>
                        <div class="form-group">
                            <label for="eventPrize">Event Prize (₹)</label>
                            <input type="number" id="eventPrize" name="eventPrize" required>
                        </div>
                        <div class="form-group">
                            <label for="eventExpenses">Event Expenses (₹)</label>
                            <input type="number" id="eventExpenses" name="eventExpenses">
                        </div>
                        <div class="form-group">
                            <label for="photographerName">Photographer</label>
                            <select id="photographerName" name="photographerName" required>
                                <option value="">Select Photographer</option>
                                <option value="Self">Self</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="photographerSalary">Photographer Salary (₹)</label>
                            <input type="number" id="photographerSalary" name="photographerSalary">
                        </div>
                        <div class="form-group">
                            <label for="eventDuration">Event Duration (Days)</label>
                            <input type="number" id="eventDuration" name="eventDuration" min="1" value="1">
                        </div>
                        <div class="form-group">
                            <label for="eventType">Event Type</label>
                            <select id="eventType" name="eventType" required>
                                <option value="">Select Type</option>
                                <option value="Wedding">Wedding</option>
                                <option value="Pre-Wedding">Pre-Wedding</option>
                                <option value="Birthday">Birthday</option>
                                <option value="Corporate">Corporate</option>
                                <option value="Fashion">Fashion</option>
                                <option value="Portrait">Portrait</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group" style="margin-top: 20px;">
                        <label for="eventNotes">Notes</label>
                        <textarea id="eventNotes" name="eventNotes" rows="3" placeholder="Additional notes about the event..."></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit" class="btn btn-primary">Add Event</button>
                        <button type="button" class="btn btn-secondary" onclick="clearForm()">Clear Form</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- View Events Tab -->
        <div id="events" class="tab-content">
            <div class="form-section">
                <h3>All Events</h3>
                <div style="margin-bottom: 20px;">
                    <input type="text" id="searchEvents" placeholder="Search events..." style="padding: 10px; width: 300px; border: 1px solid #ddd; border-radius: 5px;">
                    <select id="filterType" style="padding: 10px; margin-left: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <option value="">All Types</option>
                        <option value="Wedding">Wedding</option>
                        <option value="Pre-Wedding">Pre-Wedding</option>
                        <option value="Birthday">Birthday</option>
                        <option value="Corporate">Corporate</option>
                        <option value="Fashion">Fashion</option>
                        <option value="Portrait">Portrait</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <table class="data-table" id="eventsTable">
                    <thead>
                        <tr>
                            <th>Event Name</th>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Prize</th>
                            <th>Expenses</th>
                            <th>Photographer</th>
                            <th>Salary</th>
                            <th>Duration</th>
                            <th>Profit</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="eventsTableBody">
                        <tr>
                            <td colspan="10" style="text-align: center; color: #666;">No events found</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Photographers Tab -->
        <div id="photographers" class="tab-content">
            <div class="form-section">
                <h3>Add Photographer</h3>
                <form id="photographerForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="photographerNameAdd">Photographer Name</label>
                            <input type="text" id="photographerNameAdd" name="photographerNameAdd" required>
                        </div>
                        <div class="form-group">
                            <label for="photographerContact">Contact Number</label>
                            <input type="tel" id="photographerContact" name="photographerContact">
                        </div>
                        <div class="form-group">
                            <label for="photographerEmail">Email</label>
                            <input type="email" id="photographerEmail" name="photographerEmail">
                        </div>
                        <div class="form-group">
                            <label for="photographerRate">Daily Rate (₹)</label>
                            <input type="number" id="photographerRate" name="photographerRate">
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit" class="btn btn-primary">Add Photographer</button>
                    </div>
                </form>
            </div>
            
            <div class="form-section">
                <h3>Photographers List</h3>
                <table class="data-table" id="photographersTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Contact</th>
                            <th>Email</th>
                            <th>Daily Rate</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="photographersTableBody">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #666;">No photographers found</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Average Event Value</h4>
                    <div class="value" id="avgEventValue">₹0</div>
                </div>
                <div class="stat-card">
                    <h4>This Month Revenue</h4>
                    <div class="value" id="monthRevenue">₹0</div>
                </div>
                <div class="stat-card">
                    <h4>Most Popular Event Type</h4>
                    <div class="value" id="popularEventType">-</div>
                </div>
                <div class="stat-card">
                    <h4>Total Event Days</h4>
                    <div class="value" id="totalEventDays">0</div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Monthly Revenue Analysis</h3>
                <canvas id="revenueChart" width="400" height="200"></canvas>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="form-section">
                <h3>Google Sheets Integration</h3>
                <div class="google-sheets-section">
                    <h4>Connection Status: <span class="status-indicator status-disconnected" id="connectionStatus">Disconnected</span></h4>
                    
                    <div class="warning-box">
                        <h5>⚠️ Important Notice</h5>
                        <p>When connecting to Google Sheets for the first time, your local data will be preserved. The system will first upload your existing data to the sheet before enabling synchronization.</p>
                    </div>
                    
                    <p>To connect with Google Sheets, you'll need to:</p>
                    <ol>
                        <li>Create a Google Sheet for your business data</li>
                        <li>Set up Google Apps Script (copy the provided script)</li>
                        <li>Deploy as web app (Execute as: Me, Who has access: Anyone)</li>
                        <li>Enter the web app URL below</li>
                    </ol>
                    <div class="form-group" style="margin-top: 15px;">
                        <label for="googleSheetUrl">Google Apps Script Web App URL</label>
                        <input type="url" id="googleSheetUrl" placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec">
                    </div>
                    
                    <div class="sync-options">
                        <button class="btn btn-primary" onclick="connectGoogleSheets()">Connect & Upload Data</button>
                        <button class="btn btn-secondary" onclick="syncToGoogleSheets(true)" id="manualSyncBtn" disabled>Manual Sync</button>
                        <button class="btn btn-secondary" onclick="loadFromGoogleSheets()" id="loadFromSheetsBtn" disabled>Load from Sheets</button>
                        <button class="btn btn-danger" onclick="disconnectGoogleSheets()">Disconnect</button>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Data Management</h3>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="exportData()">Export Data</button>
                    <button class="btn btn-secondary" onclick="importData()">Import Data</button>
                    <button class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
                </div>
            </div>
        </div>
       <!-- Salary Management Tab -->
<div id="salary-management" class="tab-content">
    <h2>Salary Management</h2>
    
    <!-- Attendance Section -->
    <div class="card">
        <h3>Mark Attendance</h3>
        <form id="attendanceForm">
            <div class="form-group">
                <label>Photographer:</label>
                <select id="attendancePhotographer" name="attendancePhotographer" required>
                    <option value="">Select Photographer</option>
                </select>
            </div>
            <div class="form-group">
                <label>Date:</label>
                <input type="date" id="attendanceDate" name="attendanceDate" required>
            </div>
            <div class="form-group">
                <label>Status:</label>
                <select name="attendanceStatus" required>
                    <option value="">Select Status</option>
                    <option value="Present">Present</option>
                    <option value="Half-Day">Half-Day</option>
                    <option value="Absent">Absent</option>
                </select>
            </div>
            <div class="form-group">
                <label>Notes:</label>
                <textarea name="attendanceNotes" placeholder="Optional notes"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Mark Attendance</button>
        </form>
    </div>

    <!-- Salary Payment Section -->
    <div class="card">
        <h3>Record Salary Payment</h3>
        <form id="salaryPaymentForm">
            <div class="form-group">
                <label>Photographer:</label>
                <select id="paymentPhotographer" name="paymentPhotographer" required>
                    <option value="">Select Photographer</option>
                </select>
            </div>
            <div class="form-group">
                <label>Amount (₹):</label>
                <input type="number" name="paymentAmount" step="0.01" required>
            </div>
            <div class="form-group">
                <label>Payment Date:</label>
                <input type="date" id="paymentDate" name="paymentDate" required>
            </div>
            <div class="form-group">
                <label>Payment Mode:</label>
                <select name="paymentMode" required>
                    <option value="">Select Mode</option>
                    <option value="Cash">Cash</option>
                    <option value="UPI">UPI</option>
                    <option value="Bank Transfer">Bank Transfer</option>
                    <option value="Cheque">Cheque</option>
                </select>
            </div>
            <div class="form-group">
                <label>Remarks:</label>
                <textarea name="paymentRemarks" placeholder="Optional remarks"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Record Payment</button>
        </form>
    </div>

    <!-- Attendance Table -->
    <div class="card">
        <h3>Attendance Records</h3>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Photographer</th>
                        <th>Date</th>
                        <th>Status</th>
                        <th>Daily Rate</th>
                        <th>Earnings</th>
                        <th>Notes</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="attendanceTableBody">
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Expense Tracker Tab -->
<div id="expense-tracker" class="tab-content">
    <h2>Expense Tracker</h2>
    
    <div class="card">
        <h3>Add Expense</h3>
        <form id="expenseForm">
            <div class="form-group">
                <label>Date:</label>
                <input type="date" id="expenseDate" name="expenseDate" required>
            </div>
            <div class="form-group">
                <label>Category:</label>
                <select name="expenseCategory" required>
                    <option value="">Select Category</option>
                    <option value="Travel">Travel</option>
                    <option value="Equipment">Equipment</option>
                    <option value="Props">Props</option>
                    <option value="Food">Food</option>
                    <option value="Editing Tools">Editing Tools</option>
                    <option value="Marketing">Marketing</option>
                    <option value="Maintenance">Maintenance</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label>Description:</label>
                <input type="text" name="expenseDescription" placeholder="Brief description" required>
            </div>
            <div class="form-group">
                <label>Amount (₹):</label>
                <input type="number" name="expenseAmount" step="0.01" required>
            </div>
            <div class="form-group">
                <label>Payment Mode:</label>
                <select name="expensePaymentMode" required>
                    <option value="">Select Mode</option>
                    <option value="Cash">Cash</option>
                    <option value="UPI">UPI</option>
                    <option value="Bank Transfer">Bank Transfer</option>
                    <option value="Credit Card">Credit Card</option>
                    <option value="Debit Card">Debit Card</option>
                </select>
            </div>
            <div class="form-group">
                <label>Remarks:</label>
                <textarea name="expenseRemarks" placeholder="Optional remarks"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Add Expense</button>
        </form>
    </div>

    <div class="card">
        <h3>Expense Records</h3>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Category</th>
                        <th>Description</th>
                        <th>Amount</th>
                        <th>Payment Mode</th>
                        <th>Remarks</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="expenseTableBody">
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Salary Dashboard Tab -->
<div id="salary-dashboard" class="tab-content">
    <h2>Salary Dashboard</h2>
    
    <!-- Summary Cards -->
    <div class="dashboard-grid">
        <div class="card">
            <h3>Total Salary Earned</h3>
            <div class="metric" id="totalSalaryEarned">₹0</div>
        </div>
        <div class="card">
            <h3>Total Salary Paid</h3>
            <div class="metric" id="totalSalaryPaid">₹0</div>
        </div>
        <div class="card">
            <h3>Outstanding Salary</h3>
            <div class="metric" id="outstandingSalary">₹0</div>
        </div>
        <div class="card">
            <h3>Total Expenses</h3>
            <div class="metric" id="totalExpensesAmount">₹0</div>
        </div>
    </div>

    <!-- Photographer Salary Summary -->
    <div class="card">
        <h3>Photographer Salary Summary</h3>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Photographer</th>
                        <th>Days Worked</th>
                        <th>Total Earned</th>
                        <th>Total Paid</th>
                        <th>Outstanding</th>
                        <th>Last Payment</th>
                    </tr>
                </thead>
                <tbody id="salaryDashboardTableBody">
                </tbody>
            </table>
        </div>
    </div>

    <!-- Expense Breakdown -->
    <div class="card">
        <h3>Expense Breakdown</h3>
        <div id="expenseBreakdown"></div>
    </div>
</div>
<script>
    
        // Data storage
        let events = JSON.parse(localStorage.getItem('rn_studio_events')) || [];
        let photographers = JSON.parse(localStorage.getItem('rn_studio_photographers')) || [
            {id: 1, name: 'Self', contact: '', email: '', rate: 0}
        ];
        let attendanceRecords = JSON.parse(localStorage.getItem('rn_studio_attendance')) || [];
        let salaryPayments = JSON.parse(localStorage.getItem('rn_studio_salary_payments')) || [];
        let expenses = JSON.parse(localStorage.getItem('rn_studio_expenses')) || [];

        let isConnectedToSheets = false;
        let sheetsUrl = '';

        // Tab navigation
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked nav tab
            event.target.classList.add('active');
            
            // Update data when switching tabs
            if (tabName === 'dashboard') {
                updateDashboard();
            } else if (tabName === 'events') {
                loadEvents();
            } else if (tabName === 'photographers') {
                loadPhotographers();
            } else if (tabName === 'analytics') {
                updateAnalytics();
            } else if (tabName === 'salary-management') {
                loadSalaryManagement();
            } else if (tabName === 'expense-tracker') {
                loadExpenseTracker();
            } else if (tabName === 'salary-dashboard') {
                loadSalaryDashboard();
            }
        }

        // Event form submission
        document.getElementById('eventForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const eventData = {
                id: Date.now(),
                name: formData.get('eventName'),
                date: formData.get('eventDate'),
                prize: parseFloat(formData.get('eventPrize')),
                expenses: parseFloat(formData.get('eventExpenses')) || 0,
                photographer: formData.get('photographerName'),
                salary: parseFloat(formData.get('photographerSalary')) || 0,
                duration: parseInt(formData.get('eventDuration')),
                type: formData.get('eventType'),
                notes: formData.get('eventNotes'),
                profit: parseFloat(formData.get('eventPrize')) - (parseFloat(formData.get('eventExpenses')) || 0) - (parseFloat(formData.get('photographerSalary')) || 0)
            };
            
            events.push(eventData);
            saveDataLocally();
            
            // Auto-sync if connected
            if (isConnectedToSheets) {
                syncToGoogleSheets();
            }
            
            showNotification('Event added successfully!', 'success');
            clearForm();
            updateDashboard();
        });

        // Photographer form submission
        document.getElementById('photographerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const photographerData = {
                id: Date.now(),
                name: formData.get('photographerNameAdd'),
                contact: formData.get('photographerContact'),
                email: formData.get('photographerEmail'),
                rate: parseFloat(formData.get('photographerRate')) || 0
            };
            
            photographers.push(photographerData);
            saveDataLocally();
            
            // Auto-sync if connected
            if (isConnectedToSheets) {
                syncToGoogleSheets();
            }
            
            // Update photographer dropdown
            updatePhotographerDropdown();
            
            showNotification('Photographer added successfully!', 'success');
            document.getElementById('photographerForm').reset();
            loadPhotographers();
        });

          // Attendance form submission
        document.getElementById('attendanceForm').addEventListener('submit', function(e) {
            e.preventDefault();
    
            const formData = new FormData(e.target);
            const attendanceData = {
            id: Date.now(),
            photographer: formData.get('attendancePhotographer'),
            date: formData.get('attendanceDate'),
            status: formData.get('attendanceStatus'),
            notes: formData.get('attendanceNotes') || '',
            timestamp: new Date().toISOString()
    };
    
    attendanceRecords.push(attendanceData);
    saveDataLocally();
    
    // Auto-sync if connected
    if (isConnectedToSheets) {
        syncToGoogleSheets();
    }
    
    showNotification('Attendance marked successfully!', 'success');
    document.getElementById('attendanceForm').reset();
    loadAttendanceTable();
    loadSalaryDashboard();
});

// Salary payment form submission
document.getElementById('salaryPaymentForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(e.target);
    const paymentData = {
        id: Date.now(),
        photographer: formData.get('paymentPhotographer'),
        amount: parseFloat(formData.get('paymentAmount')),
        date: formData.get('paymentDate'),
        paymentMode: formData.get('paymentMode'),
        remarks: formData.get('paymentRemarks') || '',
        timestamp: new Date().toISOString()
    };
    
    salaryPayments.push(paymentData);
    saveDataLocally();
    
    // Auto-sync if connected
    if (isConnectedToSheets) {
        syncToGoogleSheets();
    }
    
    showNotification('Salary payment recorded successfully!', 'success');
    document.getElementById('salaryPaymentForm').reset();
    loadSalaryDashboard();
});

// Expense form submission
document.getElementById('expenseForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(e.target);
    const expenseData = {
        id: Date.now(),
        date: formData.get('expenseDate'),
        category: formData.get('expenseCategory'),
        description: formData.get('expenseDescription'),
        amount: parseFloat(formData.get('expenseAmount')),
        paymentMode: formData.get('expensePaymentMode'),
        remarks: formData.get('expenseRemarks') || '',
        timestamp: new Date().toISOString()
    };
    
    expenses.push(expenseData);
    saveDataLocally();
    
    // Auto-sync if connected
    if (isConnectedToSheets) {
        syncToGoogleSheets();
    }
    
    showNotification('Expense added successfully!', 'success');
    document.getElementById('expenseForm').reset();
    loadExpenseTable();
    loadSalaryDashboard();
});

        // Save data to localStorage
        function saveDataLocally() {
            localStorage.setItem('rn_studio_events', JSON.stringify(events));
            localStorage.setItem('rn_studio_photographers', JSON.stringify(photographers));
            localStorage.setItem('rn_studio_attendance', JSON.stringify(attendanceRecords));
            localStorage.setItem('rn_studio_salary_payments', JSON.stringify(salaryPayments));
            localStorage.setItem('rn_studio_expenses', JSON.stringify(expenses));
        }

        // Update photographer dropdown
        function updatePhotographerDropdown() {
            const select = document.getElementById('photographerName');
            select.innerHTML = '<option value="">Select Photographer</option>';
            
            photographers.forEach(photographer => {
                const option = document.createElement('option');
                option.value = photographer.name;
                option.textContent = photographer.name;
                select.appendChild(option);
            });
        }

        // Load events table
        function loadEvents() {
            const tbody = document.getElementById('eventsTableBody');
            tbody.innerHTML = '';
            
            if (events.length === 0) {
                tbody.innerHTML = '<tr><td colspan="10" style="text-align: center; color: #666;">No events found</td></tr>';
                return;
            }
            
            events.forEach(event => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${event.name}</td>
                    <td>${new Date(event.date).toLocaleDateString()}</td>
                    <td>${event.type}</td>
                    <td>₹${event.prize.toLocaleString()}</td>
                    <td>₹${event.expenses.toLocaleString()}</td>
                    <td>${event.photographer}</td>
                    <td>₹${event.salary.toLocaleString()}</td>
                    <td>${event.duration} days</td>
                    <td style="color: ${event.profit >= 0 ? 'green' : 'red'}">₹${event.profit.toLocaleString()}</td>
                    <td>
                        <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deleteEvent(${event.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Load photographers table
        function loadPhotographers() {
            const tbody = document.getElementById('photographersTableBody');
            tbody.innerHTML = '';
            
            if (photographers.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #666;">No photographers found</td></tr>';
                return;
            }
            
            photographers.forEach(photographer => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${photographer.name}</td>
                    <td>${photographer.contact}</td>
                    <td>${photographer.email}</td>
                    <td>₹${photographer.rate.toLocaleString()}</td>
                    <td>
                        <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deletePhotographer(${photographer.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Update dashboard
        function updateDashboard() {
            const totalEvents = events.length;
            const totalRevenue = events.reduce((sum, event) => sum + event.prize, 0);
            const totalExpenses = events.reduce((sum, event) => sum + event.expenses + event.salary, 0);
            const netProfit = totalRevenue - totalExpenses;
            
            document.getElementById('totalEvents').textContent = totalEvents;
            document.getElementById('totalRevenue').textContent = '₹' + totalRevenue.toLocaleString();
            document.getElementById('totalExpenses').textContent = '₹' + totalExpenses.toLocaleString();
            document.getElementById('netProfit').textContent = '₹' + netProfit.toLocaleString();
            
            // Update recent events
            const recentEvents = events.slice(-5).reverse();
            const tbody = document.getElementById('recentEventsBody');
            tbody.innerHTML = '';
            
            if (recentEvents.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #666;">No events found</td></tr>';
            } else {
                recentEvents.forEach(event => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${event.name}</td>
                        <td>${new Date(event.date).toLocaleDateString()}</td>
                        <td>₹${event.prize.toLocaleString()}</td>
                        <td>${event.photographer}</td>
                        <td><span class="status-indicator status-connected">Completed</span></td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        // Update analytics
        function updateAnalytics() {
            const avgEventValue = events.length > 0 ? events.reduce((sum, event) => sum + event.prize, 0) / events.length : 0;
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const monthRevenue = events.filter(event => {
                const eventDate = new Date(event.date);
                return eventDate.getMonth() === currentMonth && eventDate.getFullYear() === currentYear;
            }).reduce((sum, event) => sum + event.prize, 0);
            
            const eventTypes = {};
            events.forEach(event => {
                eventTypes[event.type] = (eventTypes[event.type] || 0) + 1;
            });
            
            const popularEventType = Object.keys(eventTypes).length > 0 ? 
                Object.keys(eventTypes).reduce((a, b) => eventTypes[a] > eventTypes[b] ? a : b) : '-';
            
            const totalEventDays = events.reduce((sum, event) => sum + event.duration, 0);
            
            document.getElementById('avgEventValue').textContent = '₹' + Math.round(avgEventValue).toLocaleString();
            document.getElementById('monthRevenue').textContent = '₹' + monthRevenue.toLocaleString();
            document.getElementById('popularEventType').textContent = popularEventType;
            document.getElementById('totalEventDays').textContent = totalEventDays;
        }

        function loadSalaryManagement() {
    updatePhotographerDropdowns();
    loadAttendanceTable();
    
    // Set default dates
    document.getElementById('attendanceDate').valueAsDate = new Date();
    document.getElementById('paymentDate').valueAsDate = new Date();
}

function updatePhotographerDropdowns() {
    const dropdowns = ['attendancePhotographer', 'paymentPhotographer', 'attendanceFilterPhotographer'];
    
    dropdowns.forEach(dropdownId => {
        const select = document.getElementById(dropdownId);
        const currentValue = select.value;
        select.innerHTML = dropdownId.includes('Filter') ? 
            '<option value="">All Photographers</option>' : 
            '<option value="">Select Photographer</option>';
        
        photographers.forEach(photographer => {
            if (photographer.name !== 'Self' || photographer.rate > 0) {
                const option = document.createElement('option');
                option.value = photographer.name;
                option.textContent = photographer.name;
                select.appendChild(option);
            }
        });
        
        select.value = currentValue;
    });
}

function loadAttendanceTable() {
    const tbody = document.getElementById('attendanceTableBody');
    tbody.innerHTML = '';
    
    if (attendanceRecords.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #666;">No attendance records found</td></tr>';
        return;
    }
    
    const sortedRecords = attendanceRecords.sort((a, b) => new Date(b.date) - new Date(a.date));
    
    sortedRecords.forEach(record => {
        const photographer = photographers.find(p => p.name === record.photographer);
        const dailyRate = photographer ? photographer.rate : 0;
        let earnings = 0;
        
        if (record.status === 'Present') {
            earnings = dailyRate;
        } else if (record.status === 'Half-Day') {
            earnings = dailyRate / 2;
        }
        
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${record.photographer}</td>
            <td>${new Date(record.date).toLocaleDateString()}</td>
            <td><span class="status-indicator ${record.status === 'Present' ? 'status-connected' : record.status === 'Half-Day' ? 'status-warning' : 'status-disconnected'}">${record.status}</span></td>
            <td>₹${dailyRate.toLocaleString()}</td>
            <td>₹${earnings.toLocaleString()}</td>
            <td>${record.notes}</td>
            <td>
                <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deleteAttendance(${record.id})">Delete</button>
            </td>
        `;
        tbody.appendChild(row);
    });
}

function loadExpenseTracker() {
    loadExpenseTable();
    
    // Set default date
    document.getElementById('expenseDate').valueAsDate = new Date();
}

function loadExpenseTable() {
    const tbody = document.getElementById('expenseTableBody');
    tbody.innerHTML = '';
    
    if (expenses.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #666;">No expense records found</td></tr>';
        return;
    }
    
    const sortedExpenses = expenses.sort((a, b) => new Date(b.date) - new Date(a.date));
    
    sortedExpenses.forEach(expense => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${new Date(expense.date).toLocaleDateString()}</td>
            <td>${expense.category}</td>
            <td>${expense.description}</td>
            <td>₹${expense.amount.toLocaleString()}</td>
            <td>${expense.paymentMode}</td>
            <td>${expense.remarks}</td>
            <td>
                <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deleteExpense(${expense.id})">Delete</button>
            </td>
        `;
        tbody.appendChild(row);
    });
}

function loadSalaryDashboard() {
    updateSalaryStats();
    loadSalaryDashboardTable();
    loadExpenseBreakdown();
}

function updateSalaryStats() {
    // Calculate total salary earned
    const totalEarned = attendanceRecords.reduce((sum, record) => {
        const photographer = photographers.find(p => p.name === record.photographer);
        const dailyRate = photographer ? photographer.rate : 0;
        
        if (record.status === 'Present') {
            return sum + dailyRate;
        } else if (record.status === 'Half-Day') {
            return sum + (dailyRate / 2);
        }
        return sum;
    }, 0);
    
    // Calculate total salary paid
    const totalPaid = salaryPayments.reduce((sum, payment) => sum + payment.amount, 0);
    
    // Calculate outstanding salary
    const outstanding = totalEarned - totalPaid;
    
    // Calculate total expenses
    const totalExpensesAmount = expenses.reduce((sum, expense) => sum + expense.amount, 0);
    
    document.getElementById('totalSalaryEarned').textContent = '₹' + totalEarned.toLocaleString();
    document.getElementById('totalSalaryPaid').textContent = '₹' + totalPaid.toLocaleString();
    document.getElementById('outstandingSalary').textContent = '₹' + outstanding.toLocaleString();
    document.getElementById('totalExpensesAmount').textContent = '₹' + totalExpensesAmount.toLocaleString();
}

function loadSalaryDashboardTable() {
    const tbody = document.getElementById('salaryDashboardTableBody');
    tbody.innerHTML = '';
    
    const photographerSummary = {};
    
    // Calculate earnings for each photographer
    attendanceRecords.forEach(record => {
        if (!photographerSummary[record.photographer]) {
            photographerSummary[record.photographer] = {
                name: record.photographer,
                daysWorked: 0,
                totalEarned: 0,
                totalPaid: 0,
                lastPayment: null
            };
        }
        
        const photographer = photographers.find(p => p.name === record.photographer);
        const dailyRate = photographer ? photographer.rate : 0;
        
        if (record.status === 'Present') {
            photographerSummary[record.photographer].daysWorked += 1;
            photographerSummary[record.photographer].totalEarned += dailyRate;
        } else if (record.status === 'Half-Day') {
            photographerSummary[record.photographer].daysWorked += 0.5;
            photographerSummary[record.photographer].totalEarned += (dailyRate / 2);
        }
    });
    
    // Calculate payments for each photographer
    salaryPayments.forEach(payment => {
        if (photographerSummary[payment.photographer]) {
            photographerSummary[payment.photographer].totalPaid += payment.amount;
            if (!photographerSummary[payment.photographer].lastPayment || 
                new Date(payment.date) > new Date(photographerSummary[payment.photographer].lastPayment)) {
                photographerSummary[payment.photographer].lastPayment = payment.date;
            }
        }
    });
    
    if (Object.keys(photographerSummary).length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: #666;">No salary data found</td></tr>';
        return;
    }
    
    Object.values(photographerSummary).forEach(summary => {
        const outstanding = summary.totalEarned - summary.totalPaid;
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${summary.name}</td>
            <td>${summary.daysWorked}</td>
            <td>₹${summary.totalEarned.toLocaleString()}</td>
            <td>₹${summary.totalPaid.toLocaleString()}</td>
            <td style="color: ${outstanding > 0 ? 'red' : 'green'}">₹${outstanding.toLocaleString()}</td>
            <td>${summary.lastPayment ? new Date(summary.lastPayment).toLocaleDateString() : 'Never'}</td>
        `;
        tbody.appendChild(row);
    });
}

function loadExpenseBreakdown() {
    const breakdownDiv = document.getElementById('expenseBreakdown');
    
    if (expenses.length === 0) {
        breakdownDiv.innerHTML = '<p style="text-align: center; color: #666;">No expense data found</p>';
        return;
    }
    
    const categoryTotals = {};
    expenses.forEach(expense => {
        categoryTotals[expense.category] = (categoryTotals[expense.category] || 0) + expense.amount;
    });
    
    const totalExpenses = Object.values(categoryTotals).reduce((sum, amount) => sum + amount, 0);
    
    let html = '<div class="expense-breakdown-grid">';
    Object.entries(categoryTotals).forEach(([category, amount]) => {
        const percentage = ((amount / totalExpenses) * 100).toFixed(1);
        html += `
            <div class="expense-category">
                <div class="category-header">
                    <span class="category-name">${category}</span>
                    <span class="category-amount">₹${amount.toLocaleString()}</span>
                </div>
                <div class="category-bar">
                    <div class="category-progress" style="width: ${percentage}%"></div>
                </div>
                <div class="category-percentage">${percentage}%</div>
            </div>
        `;
    });
    html += '</div>';
    
    breakdownDiv.innerHTML = html;
}

// Delete functions
function deleteAttendance(id) {
    if (confirm('Are you sure you want to delete this attendance record?')) {
        attendanceRecords = attendanceRecords.filter(record => record.id !== id);
        saveDataLocally();
        loadAttendanceTable();
        loadSalaryDashboard();
        showNotification('Attendance record deleted successfully!', 'success');
    }
}

function deleteExpense(id) {
    if (confirm('Are you sure you want to delete this expense record?')) {
        expenses = expenses.filter(expense => expense.id !== id);
        saveDataLocally();
        loadExpenseTable();
        loadSalaryDashboard();
        showNotification('Expense record deleted successfully!', 'success');
    }
}


        // Utility functions
        function clearForm() {
            document.getElementById('eventForm').reset();
        }

        function deleteEvent(id) {
            if (confirm('Are you sure you want to delete this event?')) {
                events = events.filter(event => event.id !== id);
                localStorage.setItem('rn_studio_events', JSON.stringify(events));
                loadEvents();
                updateDashboard();
            }
        }

        function deletePhotographer(id) {
            if (confirm('Are you sure you want to delete this photographer?')) {
                photographers = photographers.filter(photographer => photographer.id !== id);
                localStorage.setItem('rn_studio_photographers', JSON.stringify(photographers));
                updatePhotographerDropdown();
                loadPhotographers();
            }
        }

        // Search and filter functions
        document.getElementById('searchEvents').addEventListener('input', function() {
            filterEvents();
        });

        document.getElementById('filterType').addEventListener('change', function() {
            filterEvents();
        });

        function filterEvents() {
            const searchTerm = document.getElementById('searchEvents').value.toLowerCase();
            const filterType = document.getElementById('filterType').value;
            
            let filteredEvents = events;
            
            if (searchTerm) {
                filteredEvents = filteredEvents.filter(event => 
                    event.name.toLowerCase().includes(searchTerm) ||
                    event.photographer.toLowerCase().includes(searchTerm)
                );
            }
            
            if (filterType) {
                filteredEvents = filteredEvents.filter(event => event.type === filterType);
            }
            
            displayFilteredEvents(filteredEvents);
        }

        function displayFilteredEvents(filteredEvents) {
            const tbody = document.getElementById('eventsTableBody');
            tbody.innerHTML = '';
            
            if (filteredEvents.length === 0) {
                tbody.innerHTML = '<tr><td colspan="10" style="text-align: center; color: #666;">No events found</td></tr>';
                return;
            }
            
            filteredEvents.forEach(event => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${event.name}</td>
                    <td>${new Date(event.date).toLocaleDateString()}</td>
                    <td>${event.type}</td>
                    <td>₹${event.prize.toLocaleString()}</td>
                    <td>₹${event.expenses.toLocaleString()}</td>
                    <td>${event.photographer}</td>
                    <td>₹${event.salary.toLocaleString()}</td>
                    <td>${event.duration} days</td>
                    <td style="color: ${event.profit >= 0 ? 'green' : 'red'}">₹${event.profit.toLocaleString()}</td>
                    <td>
                        <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deleteEvent(${event.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        //search && filter option for Attendance
        document.getElementById('attendanceFilterPhotographer').addEventListener('input', function() {
            filterAttendance();
        });

        document.getElementById('attendanceFilterPhotographer').addEventListener('change', function() {
            filterAttendance();
        });

        function filterAttendance() {
            const searchTerm = document.getElementById('attendanceFilterPhotographer').value.toLowerCase();
            const filteredRecords = attendanceRecords.filter(record => 
                record.photographer.toLowerCase().includes(searchTerm)
            );
            displayFilteredAttendance(filteredRecords);
        }

        function displayFilteredAttendance(filteredRecords) {
            const tbody = document.getElementById('attendanceTableBody');
            tbody.innerHTML = '';
            
            if (filteredRecords.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #666;">No attendance records found</td></tr>';
                return;
            }
            
            filteredRecords.forEach(record => {
                const photographer = photographers.find(p => p.name === record.photographer);
                const dailyRate = photographer ? photographer.rate : 0;
                let earnings = 0;
                
                if (record.status === 'Present') {
                    earnings = dailyRate;
                } else if (record.status === 'Half-Day') {
                    earnings = dailyRate / 2;
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.photographer}</td>
                    <td>${new Date(record.date).toLocaleDateString()}</td>
                    <td><span class="status-indicator ${record.status === 'Present' ? 'status-connected' : record.status === 'Half-Day' ? 'status-warning' : 'status-disconnected'}">${record.status}</span></td>
                    <td>₹${dailyRate.toLocaleString()}</td>
                    <td>₹${earnings.toLocaleString()}</td>
                    <td>${record.notes}</td>
                    <td>
                        <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deleteAttendance(${record.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        //Search & Filter Option for Expense Record
        document.getElementById('expenseFilterCategory').addEventListener('input', function() {
            filterExpense();
        });

        document.getElementById('expenseFilterCategory').addEventListener('change', function() {
            filterExpense();
        });

        function filterExpense() {
            const searchTerm = document.getElementById('expenseFilterCategory').value.toLowerCase();
            const filteredExpenses = expenses.filter(expense => 
                expense.category.toLowerCase().includes(searchTerm)
            );
            displayFilteredExpenses(filteredExpenses);
        }

        function displayFilteredExpenses(filteredExpenses) {
            const tbody = document.getElementById('expenseTableBody');
            tbody.innerHTML = '';
            
            if (filteredExpenses.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #666;">No expense records found</td></tr>';
                return;
            }
            
            filteredExpenses.forEach(expense => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(expense.date).toLocaleDateString()}</td>
                    <td>${expense.category}</td>
                    <td>${expense.description}</td>
                    <td>₹${expense.amount.toLocaleString()}</td>
                    <td>${expense.paymentMode}</td>
                    <td>${expense.remarks}</td>
                    <td>
                        <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deleteExpense(${expense.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }


        // Google Sheets integration
        function connectGoogleSheets() {
    const url = document.getElementById('googleSheetUrl').value;
    if (!url) {
        alert('Please enter the Google Apps Script URL');
        return;
    }
    
    // Store the URL
    localStorage.setItem('rn_studio_sheets_url', url);
    sheetsUrl = url;
    
    // First check if data already exists in sheets
    checkSheetsData().then(hasData => {
        if (hasData) {
            // Data exists in sheets, ask user what to do
            const choice = confirm(
                'Data already exists in Google Sheets. Click OK to load data from sheets, or Cancel to upload your local data to sheets.'
            );
            
            if (choice) {
                // Load from sheets
                loadFromGoogleSheets();
            } else {
                // Upload local data to sheets
                uploadLocalDataToSheets();
            }
        } else {
            // No data in sheets, upload local data
            uploadLocalDataToSheets();
        }
        
        // Update UI
        updateConnectionStatus(true);
    }).catch(error => {
        console.error('Error connecting to Google Sheets:', error);
        // Still mark as connected for sync purposes
        updateConnectionStatus(true);
        // Upload local data as fallback
        uploadLocalDataToSheets();
    });
}
function checkSheetsData() {
    return new Promise((resolve, reject) => {
        const url = localStorage.getItem('rn_studio_sheets_url');
        if (!url) {
            reject('No URL configured');
            return;
        }
        
        const callback = 'checkDataCallback' + Date.now();
        
        // Create JSONP callback
        window[callback] = function(data) {
            resolve(data.hasData);
            delete window[callback];
            document.body.removeChild(script);
        };
        
        // Create script tag for JSONP
        const script = document.createElement('script');
        script.src = url + '?action=checkData&callback=' + callback;
        script.onerror = () => {
            reject('Failed to check sheets data');
            delete window[callback];
            document.body.removeChild(script);
        };
        
        document.body.appendChild(script);
    });
}

function updateConnectionStatus(connected) {
    const statusElement = document.getElementById('connectionStatus');
    const manualSyncBtn = document.getElementById('manualSyncBtn');
    const loadFromSheetsBtn = document.getElementById('loadFromSheetsBtn');
    
    if (connected) {
        statusElement.textContent = 'Connected';
        statusElement.className = 'status-indicator status-connected';
        manualSyncBtn.disabled = false;
        loadFromSheetsBtn.disabled = false;
        isConnectedToSheets = true;
        showNotification('Connected to Google Sheets successfully!', 'success');
    } else {
        statusElement.textContent = 'Disconnected';
        statusElement.className = 'status-indicator status-disconnected';
        manualSyncBtn.disabled = true;
        loadFromSheetsBtn.disabled = true;
        isConnectedToSheets = false;
    }
}

function uploadLocalDataToSheets() {
    if (events.length === 0 && photographers.length <= 1 && attendanceRecords.length === 0 && salaryPayments.length === 0 && expenses.length === 0) {
        showNotification('No local data to upload', 'info');
        return;
    }
    
    showNotification('Uploading local data to Google Sheets...', 'info');
    syncToGoogleSheets(false, true); // false = no manual notification, true = initial upload
}

        // Data management functions
       function exportData() {
    const data = {
        events: events,
        photographers: photographers,
        attendanceRecords: attendanceRecords,
        salaryPayments: salaryPayments,
        expenses: expenses,
        exportDate: new Date().toISOString()
    };
    
    const dataStr = JSON.stringify(data, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
    
    const exportFileDefaultName = 'rn_studio_backup_' + new Date().toISOString().split('T')[0] + '.json';
    
    const linkElement = document.createElement('a');
    linkElement.setAttribute('href', dataUri);
    linkElement.setAttribute('download', exportFileDefaultName);
    linkElement.click();
}

// Update the importData function to handle new data
function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    input.onchange = function(e) {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const data = JSON.parse(e.target.result);
                if (data.events && data.photographers) {
                    if (confirm('This will replace all current data. Are you sure?')) {
                        events = data.events;
                        photographers = data.photographers;
                        attendanceRecords = data.attendanceRecords || [];
                        salaryPayments = data.salaryPayments || [];
                        expenses = data.expenses || [];
                        
                        saveDataLocally();
                        updatePhotographerDropdown();
                        updateDashboard();
                        loadEvents();
                        loadPhotographers();
                        loadSalaryManagement();
                        loadExpenseTracker();
                        loadSalaryDashboard();
                        
                        showNotification('Data imported successfully!', 'success');
                    }
                } else {
                    alert('Invalid backup file format.');
                }
            } catch (error) {
                alert('Error reading backup file.');
            }
        };
        reader.readAsText(file);
    };
    input.click();
}

// Update the clearAllData function to include new data
function clearAllData() {
    if (confirm('This will permanently delete all your data. Are you sure?')) {
        if (confirm('Last chance! This action cannot be undone.')) {
            events = [];
            photographers = [{id: 1, name: 'Self', contact: '', email: '', rate: 0}];
            attendanceRecords = [];
            salaryPayments = [];
            expenses = [];
            
            saveDataLocally();
            updatePhotographerDropdown();
            updateDashboard();
            loadEvents();
            loadPhotographers();
            loadSalaryManagement();
            loadExpenseTracker();
            loadSalaryDashboard();
            
            showNotification('All data cleared successfully!', 'success');
        }
    }
}
        // Update the syncToGoogleSheets function to include new data
function syncToGoogleSheets(manual = false, initialUpload = false) {
    const url = localStorage.getItem('rn_studio_sheets_url');
    if (!url) {
        if (manual) {
            showNotification('Google Sheets not configured', 'error');
        }
        return;
    }
    
    // Create hidden iframe to prevent page navigation
    const iframe = document.createElement('iframe');
    iframe.style.display = 'none';
    iframe.name = 'syncFrame';
    document.body.appendChild(iframe);
    
    // Use form submission to hidden iframe
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = url;
    form.target = 'syncFrame';
    form.style.display = 'none';
    
    const actionInput = document.createElement('input');
    actionInput.type = 'hidden';
    actionInput.name = 'action';
    actionInput.value = 'sync';
    form.appendChild(actionInput);
    
    const eventsInput = document.createElement('input');
    eventsInput.type = 'hidden';
    eventsInput.name = 'events';
    eventsInput.value = JSON.stringify(events);
    form.appendChild(eventsInput);
    
    const photographersInput = document.createElement('input');
    photographersInput.type = 'hidden';
    photographersInput.name = 'photographers';
    photographersInput.value = JSON.stringify(photographers);
    form.appendChild(photographersInput);
    
    // Add new data inputs
    const attendanceInput = document.createElement('input');
    attendanceInput.type = 'hidden';
    attendanceInput.name = 'attendanceRecords';
    attendanceInput.value = JSON.stringify(attendanceRecords);
    form.appendChild(attendanceInput);
    
    const salaryInput = document.createElement('input');
    salaryInput.type = 'hidden';
    salaryInput.name = 'salaryPayments';
    salaryInput.value = JSON.stringify(salaryPayments);
    form.appendChild(salaryInput);
    
    const expensesInput = document.createElement('input');
    expensesInput.type = 'hidden';
    expensesInput.name = 'expenses';
    expensesInput.value = JSON.stringify(expenses);
    form.appendChild(expensesInput);
    
    document.body.appendChild(form);
    form.submit();
    
    // Clean up after a delay
    setTimeout(() => {
        if (document.body.contains(form)) document.body.removeChild(form);
        if (document.body.contains(iframe)) document.body.removeChild(iframe);
    }, 2000);
    
    // Show appropriate notification
    if (manual) {
        showNotification('Data synced to Google Sheets!', 'success');
    } else if (initialUpload) {
        showNotification('Local data uploaded to Google Sheets!', 'success');
    }
}

        // Auto-sync when data changes
        function saveAndSync() {
            localStorage.setItem('rn_studio_events', JSON.stringify(events));
            localStorage.setItem('rn_studio_photographers', JSON.stringify(photographers));
            localStorage.setItem('rn_studio_attendance', JSON.stringify(attendanceRecords));
            localStorage.setItem('rn_studio_salary_payments', JSON.stringify(salaryPayments));
            localStorage.setItem('rn_studio_expenses', JSON.stringify(expenses));
            syncToGoogleSheets();
        }

        // Enhanced form validation
        document.getElementById('eventForm').addEventListener('input', function(e) {
            const target = e.target;
            if (target.name === 'photographerName' && target.value) {
                const photographer = photographers.find(p => p.name === target.value);
                if (photographer && photographer.rate > 0) {
                    document.getElementById('photographerSalary').value = photographer.rate;
                }
            }
        });


        // Load data from Google Sheets
function loadFromGoogleSheets() {
    return new Promise((resolve, reject) => {
        const url = localStorage.getItem('rn_studio_sheets_url');
        if (!url) {
            reject('Google Sheets not configured');
            return;
        }
        
        const callback = 'loadDataCallback' + Date.now();
        
        // Create JSONP callback
        window[callback] = function(data) {
            try {
                if (data.events && data.photographers) {
                    events = data.events;
                    photographers = data.photographers;
                    attendanceRecords = data.attendanceRecords || [];
                    salaryPayments = data.salaryPayments || [];
                    expenses = data.expenses || [];
                    
                    saveDataLocally();
                    updatePhotographerDropdown();
                    updateDashboard();
                    loadEvents();
                    loadPhotographers();
                    loadSalaryManagement();
                    loadExpenseTracker();
                    loadSalaryDashboard();
                    
                    showNotification('Data loaded from Google Sheets successfully!', 'success');
                    resolve(data);
                } else {
                    reject('Invalid data format');
                }
            } catch (error) {
                reject('Error processing data: ' + error.message);
            }
            
            delete window[callback];
            document.body.removeChild(script);
        };
        
        // Create script tag for JSONP
        const script = document.createElement('script');
        script.src = url + '?action=load&callback=' + callback;
        script.onerror = () => {
            reject('Failed to load data from Google Sheets');
            delete window[callback];
            if (document.body.contains(script)) {
                document.body.removeChild(script);
            }
        };
        
        document.body.appendChild(script);
    });
}

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'n':
                        e.preventDefault();
                        showTab('add-event');
                        break;
                    case 'e':
                        e.preventDefault();
                        exportData();
                        break;
                    case 's':
                        e.preventDefault();
                        syncToGoogleSheets();
                        break;
                }
            }
        });

function initializeApp() {
    updatePhotographerDropdown();
    updateDashboard();
    
    // Check for Google Sheets connection
    const storedSheetsUrl = localStorage.getItem('rn_studio_sheets_url');
    if (storedSheetsUrl) {
        document.getElementById('googleSheetUrl').value = storedSheetsUrl;
        sheetsUrl = storedSheetsUrl;
        updateConnectionStatus(true);
        
        // Don't automatically load from sheets on startup
        // Let user decide when to sync
        console.log('Google Sheets URL found, ready for manual sync');
    }
}
        // Auto-save every 5 minutes (300000 ms) - less annoying
setInterval(() => {
    localStorage.setItem('rn_studio_events', JSON.stringify(events));
    localStorage.setItem('rn_studio_photographers', JSON.stringify(photographers));
    localStorage.setItem('rn_studio_attendance', JSON.stringify(attendanceRecords));
    localStorage.setItem('rn_studio_expenses', JSON.stringify(expenses));
    localStorage.setItem('rn_studio_salary_payments', JSON.stringify(salaryPayments));
    syncToGoogleSheets(); // No notification for auto-sync
}, 300000);

        // Initialize when page loads
        window.addEventListener('load', initializeApp);
        
        // Handle page unload
        window.addEventListener('beforeunload', function() {
            saveAndSync();
        });

        // Add notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 5px;
                color: white;
                font-weight: bold;
                z-index: 1000;
                opacity: 0;
                transform: translateY(-20px);
                transition: all 0.3s ease;
                ${type === 'success' ? 'background: #28a745;' : 
            type === 'error' ? 'background: #dc3545;' :'background: #17a2b8;'} `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateY(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Enhanced error handling
        window.addEventListener('error', function(e) {
            console.error('Application error:', e);
            showNotification('An error occurred. Please try again.', 'error');
        });
        
        // Service worker registration for offline support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(function(err) {
                        console.log('ServiceWorker registration failed');
                    });
            });
        }
        // Disconnect Google Sheets
        function disconnectGoogleSheets() {
    if (confirm('Are you sure you want to disconnect from Google Sheets?')) {
        localStorage.removeItem('rn_studio_sheets_url');
        sheetsUrl = '';
        document.getElementById('googleSheetUrl').value = '';
        updateConnectionStatus(false);
        showNotification('Disconnected from Google Sheets', 'info');
    }
}
// Mobile Navigation Functions
function toggleMobileNav() {
    const hamburgerBtn = document.querySelector('.hamburger-btn');
    const navTabs = document.querySelector('.nav-tabs');
    const overlay = document.querySelector('.mobile-overlay');
    
    if (hamburgerBtn) hamburgerBtn.classList.toggle('active');
    if (navTabs) navTabs.classList.toggle('active');
    if (overlay) overlay.classList.toggle('active');
    
    // Prevent body scrolling when menu is open
    document.body.style.overflow = (navTabs && navTabs.classList.contains('active')) ? 'hidden' : 'auto';
}

function closeMobileNav() {
    const hamburgerBtn = document.querySelector('.hamburger-btn');
    const navTabs = document.querySelector('.nav-tabs');
    const overlay = document.querySelector('.mobile-overlay');
    
    if (hamburgerBtn) hamburgerBtn.classList.remove('active');
    if (navTabs) navTabs.classList.remove('active');
    if (overlay) overlay.classList.remove('active');
    document.body.style.overflow = 'auto';
}

// FIXED: Tab Navigation Functions - Now properly handles the event
function showTab(tabId) {
    console.log('showTab called with:', tabId); // Debug log
    
    // Hide all tabs
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Remove active class from all nav buttons
    document.querySelectorAll('.nav-tab').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // Show selected tab
    const targetTab = document.getElementById(tabId);
    if (targetTab) {
        targetTab.classList.add('active');
        console.log('Tab activated:', tabId); // Debug log
    } else {
        console.error('Tab not found:', tabId); // Debug log
    }
    
    // Add active class to clicked button - Find the button that was clicked
    const clickedButton = document.querySelector(`[onclick="showTab('${tabId}')"]`);
    if (clickedButton) {
        clickedButton.classList.add('active');
    }
    
    // Close mobile nav if open
    if (window.innerWidth <= 768) {
        closeMobileNav();
    }
}

// Enhanced mobile touch handling
let touchStarted = false;
let touchHandled = false;
let startX = 0;
let startY = 0;
let isSwipeFromEdge = false;

// Improved touch event handlers
document.addEventListener('touchstart', function(e) {
    if (window.innerWidth <= 768) {
        touchStarted = true;
        touchHandled = false;
        
        startX = e.touches[0].clientX;
        startY = e.touches[0].clientY;
        
        // Check if swipe starts from right edge (within 30px for easier access)
        isSwipeFromEdge = startX > window.innerWidth - 30;
    }
}, { passive: true });

document.addEventListener('touchmove', function(e) {
    if (!touchStarted || !isSwipeFromEdge || window.innerWidth > 768) return;
    
    const currentX = e.touches[0].clientX;
    const currentY = e.touches[0].clientY;
    const diffX = startX - currentX;
    const diffY = Math.abs(startY - currentY);
    
    // If it's a horizontal swipe (more horizontal than vertical)
    if (Math.abs(diffX) > diffY && Math.abs(diffX) > 30) {
        // Only prevent default for navigation swipes
        if (isSwipeFromEdge) {
            e.preventDefault();
            touchHandled = true;
        }
        
        // Swipe left from right edge to open menu
        if (diffX > 0 && !document.querySelector('.nav-tabs').classList.contains('active')) {
            toggleMobileNav();
        }
    }
}, { passive: false });

document.addEventListener('touchend', function(e) {
    if (window.innerWidth <= 768 && touchStarted) {
        const navTabs = document.querySelector('.nav-tabs');
        const endX = e.changedTouches[0].clientX;
        const diffX = startX - endX;
        
        // Close menu if swiping right while menu is open
        if (navTabs && navTabs.classList.contains('active') && diffX < -100) {
            closeMobileNav();
        }
    }
    
    // Reset touch state
    touchStarted = false;
    touchHandled = false;
    isSwipeFromEdge = false;
}, { passive: true });

// Enhanced button click handling for mobile
function enhanceMobileButtonClicks() {
    // Add touch-friendly behavior to all buttons
    document.querySelectorAll('button, .btn, .nav-tab').forEach(button => {
        // Make buttons more touch-friendly
        button.style.minHeight = '44px';
        button.style.touchAction = 'manipulation';
        
        // Add visual feedback for touch
        button.addEventListener('touchstart', function() {
            this.style.transform = 'scale(0.95)';
            this.style.transition = 'transform 0.1s';
        }, { passive: true });
        
        button.addEventListener('touchend', function() {
            this.style.transform = 'scale(1)';
        }, { passive: true });
        
        // Ensure click events work on mobile
        button.addEventListener('click', function(e) {
            // Prevent double-firing on mobile
            if (touchHandled) {
                e.preventDefault();
                return false;
            }
            
            // Add ripple effect for better feedback
            const ripple = document.createElement('span');
            ripple.style.position = 'absolute';
            ripple.style.borderRadius = '50%';
            ripple.style.background = 'rgba(255,255,255,0.6)';
            ripple.style.transform = 'scale(0)';
            ripple.style.animation = 'ripple 0.6s linear';
            ripple.style.pointerEvents = 'none';
            
            const rect = this.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = (e.clientX - rect.left - size / 2) + 'px';
            ripple.style.top = (e.clientY - rect.top - size / 2) + 'px';
            
            if (this.style.position !== 'absolute' && this.style.position !== 'relative') {
                this.style.position = 'relative';
            }
            this.appendChild(ripple);
            
            setTimeout(() => {
                if (ripple.parentNode) {
                    ripple.parentNode.removeChild(ripple);
                }
            }, 600);
        });
    });
}

// Enhanced form handling for mobile
function enhanceMobileFormHandling() {
    // Make form inputs more touch-friendly
    document.querySelectorAll('input, select, textarea').forEach(input => {
        input.style.minHeight = '44px';
        input.style.touchAction = 'manipulation';
        
        // Add focus enhancement for mobile
        input.addEventListener('focus', function() {
            this.style.outline = '2px solid #007bff';
            this.style.outlineOffset = '2px';
        });
        
        input.addEventListener('blur', function() {
            this.style.outline = 'none';
        });
    });
    
    // Enhanced form submission handling
    document.querySelectorAll('form').forEach(form => {
        form.addEventListener('submit', function(e) {
            // Add loading state to submit button
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.innerHTML = 'Processing...';
                
                // Reset button after 2 seconds (adjust based on your needs)
                setTimeout(() => {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = submitBtn.getAttribute('data-original-text') || 'Submit';
                }, 2000);
            }
        });
    });
}

// Handle window resize
window.addEventListener('resize', function() {
    if (window.innerWidth > 768) {
        closeMobileNav();
    }
});

// Hide swipe indicator after first interaction
let hasInteracted = false;
document.addEventListener('touchstart', function() {
    if (!hasInteracted) {
        const swipeIndicator = document.querySelector('.swipe-indicator');
        if (swipeIndicator) {
            swipeIndicator.style.opacity = '0';
        }
        hasInteracted = true;
    }
});

// Escape key to close menu
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && window.innerWidth <= 768) {
        closeMobileNav();
    }
});

// Add CSS for ripple effect
const style = document.createElement('style');
style.textContent = `
    @keyframes ripple {
        to {
            transform: scale(2);
            opacity: 0;
        }
    }
    
    @media (max-width: 768px) {
        button, .btn, input[type="submit"] {
            min-height: 44px !important;
            touch-action: manipulation !important;
            -webkit-touch-callout: none !important;
            -webkit-tap-highlight-color: rgba(0,0,0,0.1) !important;
        }
        
        input, select, textarea {
            min-height: 44px !important;
            touch-action: manipulation !important;
            font-size: 16px !important; /* Prevent zoom on iOS */
        }
        
        .tab-content {
            padding: 20px 10px !important;
        }
        
        .form-grid {
            grid-template-columns: 1fr !important;
            gap: 15px !important;
        }
        
        .data-table {
            font-size: 14px !important;
        }
    }
`;
document.head.appendChild(style);

// Initialize mobile enhancements when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, initializing mobile enhancements');
    enhanceMobileButtonClicks();
    enhanceMobileFormHandling();
    
    // Store original button text for loading states
    document.querySelectorAll('button[type="submit"]').forEach(btn => {
        btn.setAttribute('data-original-text', btn.innerHTML);
    });
});

// Make functions available globally
window.showTab = showTab;
window.toggleMobileNav = toggleMobileNav;
window.closeMobileNav = closeMobileNav;

// Debug function to test tab switching
window.testTab = function(tabId) {
    console.log('Testing tab:', tabId);
    showTab(tabId);
};
    </script>

    </div>
</body>
</html>
